!function(e,t){var a=e="object"==typeof e?e:{},n="object"==typeof t?t:window;"object"==typeof module&&module.exports?n.d3=require("d3"):n.d3=n.d3,!function(e){var t=function(e,a){for(var n in a)a[n]&&a[n].constructor==Object&&e[n]?t(e[n],a[n]):e[n]=a[n]},a=function(e,t){for(var a=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(a[i]=r[i])}return a},n=function(e,t){for(;t.lastChild;)t.removeChild(t.lastChild);return r(e,t)},r=function(e,t){return t.appendChild(document.importNode((new DOMParser).parseFromString(e,"text/html").body.childNodes[0],!0))},i=function(e,t){var a;return function(){return e&&(a=e.apply(t||this,arguments),e=null),a}},l=function(e,t){var a=!1,n=null;return function(){var r=this;a||(a=!0,clearTimeout(n),n=setTimeout(function(){a=!1,e.apply(r,arguments)},t))}},s=function(e,t){var a,n,r,i,l=[],s=[],c=Number.MAX_VALUE,o=Number.MIN_VALUE,u={};for(r=0;r<e.length;r++)for(a=e[r],i=0;i<a.length;i++)n=t?t(a[i]):a[i],l.push(n),u.hasOwnProperty(n)||null===n||(u[n]=1,n>o&&(o=n),c>n&&(c=n));return s=Object.keys(u).map(function(e,t){return+e}),{flattened:l,uniques:s,max:o,min:c}},c=function(e,t){return s(e,t).uniques},o=function(e,t){return s(e,t).flattened},u=function(e,t,a){for(var n,r=0,i=e.length-1;i>r;)n=r+i>>1,a&&t>=e[n]||!a&&t<e[n]?i=n:r=n+1;return r},d=function(e,t){return u(e,t,!0)},m=function(e){var t,a=0,n=e.length;for(t=0;n>t;t++)e[t]>a&&(a=e[t]);return a},h=function(e){var t,a=1/0,n=e.length;for(t=0;n>t;t++)e[t]<a&&(a=e[t]);return a},v=function(e){return e.slice(4).slice(0,-1).split(",").map(function(e,t){return parseInt(e)})},f=function(){var e=arguments,t=this;return function(a){for(var n=0;n<e.length;n++){var r=e[n].call(this,a);a=t.mergeAll(a,r)}return a}},p=function(e,t){for(var a in t)a in e&&(e[a]=t[a])},g=function(e){return function(){return e.on.apply(e,arguments),this}},x=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},b=function(e,t){var a=t?"min":"max";return e?d3[a](e.map(function(e){return e.value})):null},y=function(e,t){var a=t?"min":"max";if(e&&e.length){var n=e.map(function(e){return d3.sum(e.value)});return d3[a](n)}return null},w=function(e,t){var a=t?"min":"max";if(e&&e.length){var n=e.map(function(e,t){return e.value});return n[0].length&&(n=d3.merge(n)),d3[a](n)}return null};e.utils={merge:t,mergeAll:a,htmlToNode:n,appendHtmlToNode:r,once:i,throttle:l,arrayStats:s,arrayUniques:c,arrayFlatten:o,bisection:u,bisectionReversed:d,findMax:m,findMin:h,parseRGB:v,pipeline:f,override:p,rebind:g,capitalize:x,getExtent:b,getStackExtent:y,getMultiExtent:w}}(a),!function(e,t){var a=function(e){var a=t.utcFormat("%b %e, %Y at %H:%M UTC"),n="";if(!e.dataIsEmpty){var r=function(e){return e%1?~~(100*e)/100:e},i=[],l=t.extent(e.timestamps),s=l[0],c=l[1];s.getTime()===c.getTime()&&s.getUTCMonth()===c.getUTCMonth()||i.push("%b %e"),s.getYear()!==c.getYear()&&i.push("%Y"),s.getYear()===c.getYear()&&s.getUTCHours()!==c.getUTCHours()&&i.push("%H:%M"),n=t.utcFormat(i.join(" "))}return{axisXFormat:n,axisTitleXFormat:function(e){return a(e.data.x)},tooltipFormat:function(e){return r(e.data.y)}}},n=function(e){var t={top:50,right:50,bottom:100,left:50};return{margin:e.margin||t,width:e.width||600,height:e.height||300}},r=function(e){return e.dataConverted.sort(function(e,t){var a=e.x.getTime(),n=t.x.getTime();return n>a?-1:a>n?1:0}),{}},i=function(e){var t=!e.flattenedData.filter(function(e){return null!=e.y}).length;return{dataIsAllNulls:t}},l=function(e){var a=e.axisXFormat||"%b",n=t.utcFormat(a)||function(e){return e.toString()},r=t.axisBottom().scale(e.scaleX).tickFormat(n);return{axisX:r}},s=function(e){var a=e.axisYFormat||".2s",n=t.format(a),r=e.scaleY.range()[0],i=t.axisLeft().scale(e.scaleY).ticks(Math.max(~~(r/30),2)).tickPadding(10).tickFormat(n).tickSize(-e.chartWidth);return{axisY:i}},c=function(e){var a=e.container.selectAll("g.axis.x").data([0]),n=a.enter().append("g").attr("class","x axis").attr("transform","translate("+[0,e.chartHeight]+")").merge(a).attr("display",function(t){return e.dataIsEmpty?"none":null}).attr("transform","translate("+[0,e.chartHeight]+")");n.call(e.axisX),a.exit().remove();var r=[],i=(n.selectAll(".tick").select("text").each(function(e,t){var a=this.getBBox().width;a&&r.push(a)}),Math.floor(t.max(r)/e.stripeScaleX.bandwidth()));return i&&n.selectAll(".tick text").attr("display",function(e,t){return t%(i+1)?"none":"block"}),{}},o=function(e){var t=e.axisYPadding||0,a=e.container.selectAll("g.axis.y").data([0]);return a.enter().append("g").attr("class","y axis").attr("transform","translate("+[-t/2,0]+")").merge(a).call(e.axisY).attr("text-anchor","start").selectAll("text").attr("dx",-e.margin.left+10),a.exit().remove(),{}},u=function(e){var t=e.container.selectAll("text.axis-title.x").data([0]);return t.enter().append("text").attr("class","x axis-title").merge(t).text(e.axisTitleX||"").attr("x",e.chartWidth).attr("y",e.chartHeight),t.exit().remove(),{axisTitleXComponent:l}},d=function(e){var t=e.container.selectAll("text.axis-title.y").data([0]);t.enter().append("text").attr("class","y axis-title").merge(t).text(e.axisTitleY||"").attr("x",-e.margin.left).attr("y",-10).attr("text-anchor","start");return t.exit().remove(),{}},m=function(e){var t=e.container.selectAll("text.chart-title").data([e.chartTitle||""]);return t.enter().append("text").attr("class","chart-title").merge(t).html(function(e){return e}).attr("x",function(t){return(e.chartWidth-5*t.length)/2}).attr("y",-5),t.exit().remove(),{}},h=function(e){var t=e.container.selectAll("g.shapes").data([0]),a=t.enter().append("g").attr("class","shapes").merge(t);return t.exit().remove(),{shapePanel:a}},v=function(e){var a=t.select(e.parent).selectAll("div.widget-container").data([0]),n=a.enter().append("div").attr("class","widget-container").merge(a).attr("width",e.width).attr("height",e.height);return a.exit().remove(),{container:n}},f=function(e){var t=v(e).container,a=t.selectAll("svg").data([0]),n=a.enter().append("svg").attr("class","datahub-chart"),r=n.append("g").attr("class","panel").merge(a).attr("transform","translate("+e.margin.left+","+e.margin.top+")");return n.merge(a).attr("width",e.width).attr("height",e.height),a.exit().remove(),{root:a,container:r}},p=function(e){var t="";e.dataIsEmpty?t="(Data Unavailable)":e.dataIsAllNulls&&(t="Values are all null");var a=e.container.select(".message-group").selectAll("text").data([t]);return a.enter().append("text").merge(a).attr("x",(e.scaleX.range()[1]-e.scaleX.range()[0])/2).attr("y",function(){return e.height/2-this.getBBox().height/2}).text(function(e){return e}).attr("dx",function(e){return-this.getBBox().width/2}),a.exit().remove(),{}},g=function(e){return e.container.select("g.axis.x").selectAll(".tick text").text(function(e){return t.timeFormat("%a")(e)}),{}},x=function(e){return e.container.select("g.axis.x").selectAll(".tick text").text(function(e){return t.timeFormat("%x")(e)}),{}},b=function(e){return e.container.select("g.axis.x").selectAll(".tick text").style("transform","rotate(30deg)").style("text-anchor","start"),{}},y=function(e){return config.axisY.tickFormat(t.format(".2s")),{}},w=function(e){return e.labelsRewriterY?(e.container.selectAll("g.axis.y").selectAll("text").html(function(t,a){return e.labelsRewriterY(t,a,e)}),{}):{}},A=function(e){console.warn(e)};e.common={axesFormatAutoconfig:a,defaultConfig:n,sortData:r,detectDataAllNulls:i,axisX:l,axisY:s,axisComponentX:c,axisComponentY:o,axisTitleComponentX:u,axisTitleComponentY:d,chartTitleComponent:m,shapePanel:h,svgContainer:f,container:v,message:p,axisXFormatterTime:g,axisXFormatterTimeHour:x,axisXFormatterRotate30:b,axisYFormatSI:y,labelsRewriterY:w,printer:A}}(a,n.d3),!function(e,t){function a(e){if(e)return!0;throw"You need to set an API key using `datahub.data.setApiKey(API_KEY)`. You can get yours at http://data.planetos.com/"}var n={currentBaseURI:"https://data.planetos.com/",baseURI:"https://api.planetos.com/v1a/",datasetsEndpoint:"https://api.planetos.com/v1/datasets/",apiKey:null},r=function(e){return n.apiKey=e,this},i=function(){return{type:"Feature",properties:{name:""},geometry:{type:"LineString",coordinates:[[-170,80],[170,80],[170,-80],[-170,-80],[-170,80]]}}},l=function(){var e=d(50,function(e,t){return{coordinates:[360*Math.random()-180,180*Math.random()-90],id:"random-point-"+t}});return c(e)},s=function(e){return Math.random().toString(36).substring(4,e+4||8)},c=function(e){return{type:"FeatureCollection",features:e.map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e.coordinates},properties:{id:e.id}}})}},o=function(e){var t="https://cdn.rawgit.com/johan/world.geo.json/master/countries.geo.json";f(t,function(t,a){e(a)})},u=function(){var t={lon:d(360,function(e,t){return t-180}),lat:d(180,function(e,t){return 180-t-90}),values:d(180,function(e,t){return d(360,function(e,t){return~~(100*Math.random())})})};return t.uniqueValues=e.utils.arrayUniques(t.values),t},d=function(e,t){var a=t||function(e,t){return 0};return Array.apply(null,Array(e)).map(a)},m=function(e){var e=e||{},t={count:e.count||12,layerCount:e.layerCount||1,timeStart:e.timeStart||"2016-01-01",timeIncrement:e.timeIncrement||"month",step:e.step||1,min:e.min||0,max:e.max||100},a=~~(Math.random()*(t.max-t.min))+t.min,n=d(t.count,function(){return d(t.layerCount,function(e){return a+=(2*Math.random()-1)*((t.max-t.min)/10),a=Math.max(a,t.min)})}),r=v(t),i=r.map(function(e,t){return{timestamp:e,value:n[t],id:n[t].map(function(e){return~~(1e3*Math.random())}),className:n[t].map(function(e){return Math.random().toString(36).substring(4,8)})}});return i},h=function(e){var e=e||{},t={count:e.count||12,layerCount:e.layerCount||1,timeStart:e.timeStart||"2016-01-01",timeIncrement:e.timeIncrement||"month",step:e.step||1,min:e.min||0,max:e.max||100},a=~~(Math.random()*(t.max-t.min))+t.min,n=d(t.layerCount,function(){var e={},n=v(t);return e.data=d(t.count,function(e,r){return a+=(2*Math.random()-1)*((t.max-t.min)/10),a=Math.max(a,t.min),a=Math.min(a,t.max),{value:a,timestamp:n[r]}}),e.metadata={id:s(8)},e});return n},v=function(a){var a=a||{},n={count:a.count||12,layerCount:a.layerCount||1,timeStart:a.timeStart||"2016-01-01",timeIncrement:a.timeIncrement||"month",step:a.step||1,min:a.min||0,max:a.max||100},r="utc"+e.utils.capitalize(n.timeIncrement)||"utcHour",i=t[r],l=t[r+"s"],s=n.timeStart?new Date(n.timeStart):new Date,c=i.offset(s,n.count*n.step),o=l(s,c,n.step),u=o.map(function(e,a){return t.isoFormat(e)});return u},f=function(e,t){var a="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("get",e,!0),a.onreadystatechange=function(){var e,n;4==a.readyState&&(e=a.status,200==e?(n=JSON.parse(a.responseText),t(null,n)):t(e))},a.send()},p=function(e,t){a(n.apiKey);var r=n.baseURI+"/datasets/"+e+"?apikey="+n.apiKey;return console.log("get dataset details",r),f(r,function(e,a){if(void 0===a)return console.log("Can not render dataset because of API error",e),!1;var n=a.FeatureType||"timeseries",r="grid"===n.toLowerCase().trim()?"raster":"timeseries";console.log("Data type:",r,a.ProductType,a.FeatureType,a),t({datasetInfo:a,dataType:r,productType:a.ProductType})}),this},g=function(e,t,r){a(n.apiKey);var i=n.baseURI+"/datasets/"+e+"/variables?apikey="+n.apiKey;return console.log("query variables",i),f(i,function(a,n){var i,l=n[e],s=t;s&&(i=l.filter(function(e){return e.name===s})[0]);var c=i||l[0];r({variables:l,defaultVariable:c})}),this},x=function(e,t,r){a(n.apiKey);var i=n.baseURI+"/datasets/"+e+"/variables/"+encodeURIComponent(t)+"/timestamps?apikey="+n.apiKey;return console.log("query timestamps",i),f(i,function(e,t){if(e)return void console.log("Server error",e);var a=t.map(function(e){return new Date(parseInt(e))});r({timestamps:a})}),this},b=function(t,r,i,l){a(n.apiKey);var s=n.baseURI+"/datasets/"+t+"/variables/"+encodeURIComponent(r);return i&&(s+="/timestamps/"+i),s+="/sample_data",s+="?apikey="+n.apiKey,console.log("query dataset",s),f(s,function(a,i){if(a)return void console.log("Server error",a);i.values=i.values.map(function(e,t){return e.map(function(e){return-999===e?null:e})}),i.uniqueValues=e.utils.arrayUniques(i.values).sort();var c=n.currentBaseURI+"/datasets/"+t+"?variable="+r;l({json:i,uri:s,datahubLink:c})}),this},y=function(e,t){a(n.apiKey);var r=n.datasetsEndpoint+e+"/stations?apikey="+n.apiKey;return console.log("get stations",r),f(r,function(e,a){if(e)return void console.log("Server error",e);var n=[];for(var r in a.station){var i=a.station[r];void 0!==i.SpatialExtent&&n.push({id:r,coordinates:i.SpatialExtent.coordinates})}t({stations:n,defaultStation:n[0]})}),this},w=function(e,t,r,i,l){a(n.apiKey);var s=500,c=n.datasetsEndpoint+e+"/stations/"+t+"?apikey="+n.apiKey+"&verbose=true&count="+s;return i||(c+="&time_order=desc"),console.log("station variable",c),f(c,function(t,a){if(t)return void console.log("Server error",t);console.log("Point API data",a,c);var i,s,o={},u=a.metadata.contexts;for(var d in u){i=u[d].dataVariables;for(var m in i)s=i[m],s.key=m,o[m]=s}var h={};a.entries.forEach(function(e){for(var t in e.data)h[t]||(h[t]={values:[],timestamps:[]}),h[t].values.push(e.data[t]),h[t].timestamps.push(new Date(e.axes.time))});var v=[];for(var f in o)v.push(o[f]);var p=n.currentBaseURI+"/datasets/"+e+"?variable="+r;l({datasets:h,variablesMetadata:o,variables:v,datahubLink:p,variableData:h[r],variableMetadata:o[r]})}),this},A=function(e,t,r,i,l){a(n.apiKey);var s=n.baseURI+"/datasets/"+e+"/variables/"+encodeURIComponent(t);return r&&(s+="/timestamps/"+r),s+="/image",s+="?width="+i+"&projection=mercator",s+="&apikey="+n.apiKey,console.log("query image",s),f(s,function(e,t){l(t.img,t.metadata)}),this};e.data={generateRaster:u,generateGeojson:i,generateTimeSeries:m,generateTimeSeriesSplit:h,generateTimestamps:v,getDatasetDetails:p,getVariables:g,getTimestamps:x,getPreview:b,getStations:y,getStationVariables:w,getImage:A,getJSON:f,apiConfig:n,pointsToFeatures:c,generateGeojsonPoints:l,getWorldVector:o,setApiKey:r}}(a,n.d3),!function(e,t){var a=function(e){var a=e.width-e.margin.left-e.margin.right,n=e.timeRange.map(function(e){return new Date(e)}),r=t.scaleTime().domain(n).range([0,a]);return{scaleX:r,sliderWidth:a}},n=function(e){var a=e.height-e.margin.top-e.margin.bottom,n=e.axisXFormat||t.utcFormat("%b"),r=t.axisBottom().scale(e.scaleX).tickFormat(n).tickSize(a-12);return{axisX:r,sliderHeight:a}},r=function(e){var t=e.container.selectAll("g.axis.x").data([0]);return t.enter().append("g").attr("class","x axis").attr("transform","translate("+[0,e.margin.top]+")").merge(t).transition().attr("transform","translate("+[0,e.margin.top]+")").call(e.axisX),t.exit().remove(),{}},i=function(e){e.container.classed("datahub-button-group",!0);var a=t.dispatch("click"),n=e.container.selectAll(".element").data(e.elements),r=n.enter().append("div").on("click",function(t){var n=this,i=!1;r.classed("active",function(){return isAlreadyActive=this.classList.contains("active"),isTarget=n===this,isTarget&&isAlreadyActive&&e.isTogglable!==!1&&(i=!0),e.isExclusive?(!isAlreadyActive||isAlreadyActive&&e.isTogglable===!1)&&isTarget:isTarget?!isAlreadyActive:isAlreadyActive}),a.call("click",null,{selected:i?null:t})}).merge(n).attr("class",function(e){return"element "+(e.className||"")}).classed("active",function(t){return t.key===e.defaultElementKey}).html(function(e){return e.label});return n.exit().remove(),{events:a}},l=function(e){e.container.classed("datahub-slider",!0);var a=t.dispatch("brush"),n=t.brushX().extent([[0,0],[e.sliderWidth,e.sliderHeight-12]]).handleSize(10).on("brush",function(){var n=t.event.selection,r={start:e.scaleX.invert(n[0]),end:e.scaleX.invert(n[1])};a.call("brush",null,{brushExtent:r})}),r=e.container.selectAll("g.brush").data([0]);r.enter().append("g").attr("class","brush").attr("transform","translate("+[0,e.margin.top]+")").merge(r).attr("transform","translate("+[0,e.margin.top]+")").call(n).call(n.move,e.scaleX.range());return r.exit().remove(),e.initialTimeRange,{events:a}},s=function(a){function n(e){return l.title=e||l.title,o.select(".title").html(l.title),this}function r(e){return l.value=e||l.value,o.select(".value").html(l.value),this}function i(e){return l.info=e||l.info,o.select(".info").html(l.info),this}var l={title:a.title,value:a.value,info:a.info},s='<div class="datahub-number"><div class="title"></div><div class="value"></div><div class="info"></div></div>',c=e.utils.appendHtmlToNode(s,a.parent),o=t.select(c).on("click",function(e){u.call("click",null,l)}),u=t.dispatch("click");return n(l.title),r(l.value),i(l.info),{on:e.utils.rebind(u),setTitle:n,setValue:r,setInfo:i}},c=function(a){function n(e){if(!e)return this;o.header=e,o.defaultSortKey=e[0].key;var t=c.select(".header-row").selectAll(".header-cell").data(e),a=t.enter().append("div").attr("class","header-cell").on("click",function(e,t){if(this.classList.contains("sortable")&&o.elements){var n=this,i=!1;a.classed("ascending",function(e){var t=n===this;return t&&(i=this.classList.contains("ascending"),t=!i),t}),r(o.elements,e.key,!i)}}).merge(t).classed("sortable",function(e){return e.sortable}).classed("ascending",function(e){return e.key===o.defaultSortKey}).html(function(e){return e.label});t.exit().remove()}function r(e,t,a){if(!e||!o.header)return this;o.elements=e;var n=t||o.defaultSortKey,r="undefined"==typeof a?!0:a,l=i(e,n,r),s=c.selectAll(".table-row").data(l),u=s.enter().append("div").attr("class","table-row").merge(s);s.exit().remove();var d=u.selectAll(".cell").data(function(e){return e});d.enter().append("div").attr("class","cell").merge(d).html(function(e){return e}),d.exit().remove()}function i(e,t,a){var n=o.header.map(function(e){return e.key}).indexOf(t),r=JSON.parse(JSON.stringify(e)).sort(function(e,t){return e[n]<t[n]?a?-1:1:e[n]>t[n]?a?1:-1:0});return r}var l='<div class="datahub-table"><div class="header-row"></div></div>',s=e.utils.appendHtmlToNode(l,a.parent),c=t.select(s),o={elements:a.elements,header:a.header,defaultSortKey:a.header?a.header[0].key:null};return r(a.elements),n(a.header),{setHeader:n,setElements:r}},o=function(a){function n(e){s.select(".alert-band").classed(e,!0)}function r(e){s.select(".alert-message").html(e)}var i='<div class="datahub-alert-message"><div class="alert-band"></div><div class="alert-message"></div></div>',l=e.utils.appendHtmlToNode(i,a.parent),s=t.select(l);return n(a.level),r(a.message),{setLevel:n,setMessage:r}},u=function(a){function n(){D.text(w.year),l()}function r(){k.classed("active",function(e){return e===w.month}),l()}function i(){A.call("change",null,s()),l()}function l(){A.call("update",null,s())}function s(){return{year:w.year,month:w.month,date:c(),iso:u(),formatted:o()}}function c(){return new Date(w.year,y.indexOf(w.month))}function o(e){var a=e||"%B %Y";return t.timeFormat(a)(c())}function u(e){return t.isoFormat(c())}function d(e){return w={month:y[new Date(e).getMonth()],year:new Date(e).getFullYear()},n(),r(),this}function m(e){return w.month=e,r(),this}function h(e){return w.year=e,n(),this}function v(){return y}function f(e){return w.month=y[e],r(),this}function p(){a.parent.innerHTML=null}var g='<div class="datahub-month-calendar"> <div class="year-selector">     <div class="prev-year">&lsaquo;</div>     <div class="selected-year"></div>     <div class="next-year">&rsaquo;</div> </div> <div class="month-selector"> </div></div>',x=e.utils.appendHtmlToNode(g,a.parent),b=t.select(x),y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],w={month:y[(new Date).getMonth()],year:(new Date).getFullYear()},A=t.dispatch("change","update"),D=b.select(".selected-year").text(w.year);b.select(".prev-year").on("click",function(e){w.year-=1,n(),i()}),b.select(".next-year").on("click",function(e){w.year+=1,n(),i()});var M=b.select(".month-selector").selectAll(".element").data(y),k=M.enter().append("div").attr("class","element month").text(function(e){return e}).on("click",function(e){var t=this;k.classed("active",function(){return t===this}),w.month=e,r(),i()}).merge(M).classed("active",function(e){return e===w.month});return a.defaultMonth&&a.defaultYear?(m(a.defaultMonth),h(a.defaultYear)):a.defaultMonthNumber&&a.defaultYear?(f(a.defaultMonthNumber),h(a.defaultYear)):d(a.defaultDate||new Date),i(),{on:e.utils.rebind(A),getDateFormats:s,getDate:c,getISODate:u,getFormattedDate:o,setDate:d,setMonth:m,setYear:h,getMonthNames:v,setMonthNumber:f,destroy:p}},d=function(a){function n(e){return f.html(e),o&&o.classed("active",function(t){return t.label===e}),this}function r(e){if(!e)return this;var t=h.selectAll(".element").data(e,function(e){return e.key});return o=t.enter().append("div").attr("class","element").on("mouseover",l).on("click",function(e){if(!a.ignoreClickEvents){var t=this;o.classed("active",function(){return t===this}),n(e.label),v.call("change",null,e),s()}}).merge(t).html(function(e){return e.label}),t.exit().remove(),n(a.selected||a.elements[0].label),this}function i(e){return h.classed("active",e),this}function l(){return i(!0),this}function s(){return i(!1),this}function c(){return h.classed("active")}var o,u='<div class="datahub-dropdown"> <div class="top">     <div class="title"></div>     <div class="selected-element"></div> </div> <div class="elements"></div></div>',d=e.utils.appendHtmlToNode(u,a.parent),m=t.select(d),h=m.select(".elements"),v=t.dispatch("change");m.select(".title").html(a.title);var f=m.on("mouseover",function(){var e="ontouchstart"in document.documentElement,t=h.classed("active");t||e||l()}).on("mouseout",function(){var e=h.classed("active"),t="ontouchstart"in document.documentElement;e&&!t&&s()}).select(".top").on("click",function(){var e=h.classed("active");e?s():l()}).select(".selected-element");return r(a.elements),{on:e.utils.rebind(v),toggle:i,open:l,close:s,isOpened:c,setElements:r,setSelected:n}},m=function(a){var n=t.dispatch("change"),r=d({parent:a.parent,ignoreClickEvents:!0}),i=u({parent:a.parent.querySelector(".elements"),defaultDate:a.defaultDate,defaultMonthNumber:a.defaultMonthNumber,defaultYear:a.defaultYear,defaultMonth:a.defaultMonth}).on("change",function(e){n.call("change",null,e)}).on("update",function(e){r.setSelected(e.formatted)});return r.setSelected(i.getFormattedDate()),{on:e.utils.rebind(n),toggle:r.toggle,open:r.open,close:r.close,isOpened:r.isOpened,setElements:r.setElements,setSelected:r.setSelected,getDateFormats:i.getDateFormats,getDate:i.getDate,getISODate:i.getISODate,getFormattedDate:i.getFormattedDate,setDate:i.setDate,setMonth:i.setMonth,setYear:i.setYear,getMonthNames:i.getMonthNames,setMonthNumber:i.setMonthNumber}},l=e.utils.pipeline(a,n,e.common.svgContainer,r,l),h=e.utils.pipeline(e.common.container,i);e.widget={timeSlider:l,buttonGroup:h,number:s,table:c,alertMessage:o,monthCalendar:u,dropdown:d,dropdownCalendar:m}}(a,n.d3),!function(e,t){var a=function(a){var n=a.parent.querySelector(".widget-container");if(!n){var r='<div class="widget-container"><svg class="datahub-chart"><g class="panel"><g class="stripe-group"></g><g class="area-group"></g><g class="stacked-area-group"></g><g class="reference-bar-group"></g><g class="reference-line-group"></g><g class="bar-group"></g><g class="stacked-bar-group"></g><g class="estimate-bar-group"></g><g class="line-group"></g><g class="dot-group"></g><g class="threshold-line-group"></g><g class="y axis"></g><g class="x axis"></g><g class="active-group"></g><g class="title-container"><text class="y axis-title"></text><text class="x axis-title"></text><text class="chart-title"></text></g><g class="message-group"></g><g class="events"><rect class="event-panel"></rect></g></g></svg></div>';n=e.utils.appendHtmlToNode(r,a.parent)}var i=a.width-a.margin.left-a.margin.right,l=a.height-a.margin.top-a.margin.bottom,s=t.select(n);return s.select("svg").attr("width",a.width).attr("height",a.height),s.select(".panel").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),s.select(".events rect").attr("width",i).attr("height",l).attr("opacity",0),{container:s,chartWidth:i,chartHeight:l}},n=function(e,t,a){return e[t]?e[t].map(function(e){return e.timestamp=new Date(e.timestamp),e.value=Array.isArray(e.value)&&!a?e.value[0]:e.value,e}):[]},r=function(e){return e.timestamp?e.timestamp.map(function(e){return new Date(e)}):[]},i=function(e){var t=e.data||{};return{dataIsEmpty:!t||!t.timestamp||!t.timestamp.length,data:{timestamp:r(t),stackedBarData:n(t,"stackedBarData",!0),stackedAreaData:n(t,"stackedAreaData",!0),lineData:n(t,"lineData",!0),barData:n(t,"barData"),referenceData:n(t,"referenceData"),estimateData:n(t,"estimateData"),thresholdData:n(t,"thresholdData"),areaData:n(t,"areaData")}}},l=function(e){var a=e.dataIsEmpty?0:e.data.timestamp,n=t.scaleBand().domain(a).range([0,e.chartWidth]).paddingInner(.4).paddingOuter(.2),r=n.copy().paddingInner(.1).paddingOuter(.05),i=n.copy().paddingInner(0).paddingOuter(0),l=n.copy().paddingInner(1).paddingOuter(.5);return{scaleX:n,referenceScaleX:r,stripeScaleX:i,lineScaleX:l}},s=function(a){var n=[];n.push(e.utils.getExtent(a.data.barData)),n.push(e.utils.getExtent(a.data.referenceData)),n.push(e.utils.getExtent(a.data.estimateData)),n.push(e.utils.getExtent(a.data.thresholdData)),n.push(e.utils.getExtent(a.data.areaData)),n.push(e.utils.getStackExtent(a.data.stackedBarData)),n.push(e.utils.getStackExtent(a.data.stackedAreaData)),n.push(e.utils.getMultiExtent(a.data.lineData));var r=[],i=!0;r.push(e.utils.getExtent(a.data.barData,i)),r.push(e.utils.getExtent(a.data.referenceData,i)),r.push(e.utils.getExtent(a.data.estimateData,i)),r.push(e.utils.getExtent(a.data.thresholdData,i)),r.push(e.utils.getExtent(a.data.areaData,i)),r.push(e.utils.getStackExtent(a.data.stackedBarData,i)),r.push(e.utils.getStackExtent(a.data.stackedAreaData,i)),r.push(e.utils.getMultiExtent(a.data.lineData,i));var l,s=t.max(n);if(a.autoScaleY){l=t.min(r);var c=(s-l)/10;l=Math.max(l-c,0),s+=c}else l=Math.min(t.min(r),0),s=Math.max(s,0);var o=[l,s];a.domain&&(o=a.domain),a.reverseY&&(o=[o[1],o[0]]);var u=t.scaleLinear().domain(o).range([a.chartHeight,0]);return{scaleY:u}},c=function(t,a,n){if(!n)return null;var r=t[a].map(function(e){return e.timestamp&&e.timestamp.getTime()}).indexOf(n.getTime());if(r>-1){var i=e.utils.mergeAll({},t[a][r]);return i.value=[].concat(t[a][r].value),i.id=[].concat(t[a][r].id),i}return null},o=function(t,a,n){if(t[a][0]){var r=e.utils.mergeAll({},t[a][0]);return r.value=[].concat(t[a][0].value),r.id=[].concat(t[a][0].id),r}return null},u=function(e,t){var a={referenceData:c(t,"referenceData",e),estimateData:c(t,"estimateData",e),barData:c(t,"barData",e),stackedBarData:c(t,"stackedBarData",e),lineData:c(t,"lineData",e),areaData:c(t,"areaData",e),stackedAreaData:c(t,"stackedAreaData",e),thresholdData:o(t,"thresholdData",e)};return a},d=function(e){var a=e.container.select(".events .event-panel").on("mousemove touchstart",function(a){if(!e.dataIsEmpty){var n=t.mouse(this)[0],r=e.stripeScaleX.bandwidth(),i=e.stripeScaleX.domain(),l=i.length,s=Math.min(~~(n/r),l-1),c=i[s],o=u(c,e.data);e.events.call("hover",null,{index:s,timestamp:c,data:o,config:e,event:t.event})}}).on("mouseout",function(t){e.events.call("mouseout",null,{})}).on("click",function(a){e.events.call("click",null,{event:t.event})});return{eventPanel:a}},m=function(e){var t=e.container.select(".bar-group").selectAll("rect.bar").data(e.data.barData);return t.enter().append("rect").merge(t).attr("class",function(e){return["bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.scaleX(t.timestamp)||0}).attr("y",function(t){return e.autoScaleY?e.chartHeight-(e.chartHeight-Math.abs(e.scaleY(t.value))):t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)}).attr("width",function(t){return e.scaleX.bandwidth()}).attr("height",function(t){return e.autoScaleY?e.chartHeight-Math.abs(e.scaleY(t.value)):Math.abs(e.scaleY(t.value)-e.scaleY(0))}),t.exit().remove(),{}},h=function(e){var t=e.container.select(".estimate-bar-group").selectAll("rect.estimate-bar").data(e.data.estimateData);return t.enter().append("rect").merge(t).attr("class",function(e){return["estimate-bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.scaleX(t.timestamp)||0}).attr("y",function(t){return e.scaleY(t.value)||0}).attr("width",function(t){return e.scaleX.bandwidth()}).attr("height",function(t){return e.chartHeight-e.scaleY(t.value)||0}),t.exit().remove(),{}},v=function(e){var t=e.container.select(".reference-bar-group").selectAll("rect.reference-bar").data(e.data.referenceData);t.enter().append("rect").merge(t).attr("class",function(e){return["reference-bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.referenceScaleX(t.timestamp)||0}).attr("y",function(t){return e.autoScaleY?e.chartHeight-(e.chartHeight-Math.abs(e.scaleY(t.value))):t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)}).attr("width",function(t){return e.referenceScaleX.bandwidth()}).attr("height",function(t){return e.autoScaleY?e.chartHeight-Math.abs(e.scaleY(t.value)):Math.abs(e.scaleY(t.value)-e.scaleY(0))}),t.exit().remove();var a=e.container.select(".reference-line-group").selectAll("path.reference-top").data(e.data.referenceData);return a.enter().append("path").attr("class","reference-top").merge(a).attr("d",function(t,a){var n=e.referenceScaleX(t.timestamp)||0,r=0;r=t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)+Math.abs(e.scaleY(t.value)-e.scaleY(0));var i=e.referenceScaleX.bandwidth();return"M"+[[n,r],[n+i,r]]}),a.exit().remove(),{}},f=function(a){if(!a.data.stackedBarData||!a.data.stackedBarData.length)return a.container.select(".stacked-bar-group").selectAll("g.stack").remove(),{};var n=a.data.stackedBarData[0].value.map(function(e,t){return"y"+t}),r=[];a.data.stackedBarData.forEach(function(t,a){var n=e.utils.mergeAll({},t);t.value&&t.value.length&&(t.value.forEach(function(e,t){n["y"+t]=e}),r.push(n))});var i=a.container.select(".stacked-bar-group").selectAll("g.stack").data(t.stack().keys(n)(r)),l=i.enter().append("g").attr("class","stack").merge(i).selectAll("rect.stacked-bar").data(function(e,t){return e.forEach(function(t){t.index=e.index}),e});return l.enter().append("rect").attr("class","stacked-bar").merge(l).attr("class",function(e,t,a){var n=e.data.id?e.data.id[e.index]:null,r=e.data.className?e.data.className[e.index]:null;return["stacked-bar","layer"+e.index,n,r].join(" ")}).filter(function(e){return!Number.isNaN(e[0])&&!Number.isNaN(e[1])}).attr("x",function(e){return a.scaleX(e.data.timestamp)}).attr("y",function(e){return a.scaleY(e[1])}).attr("height",function(e){return a.scaleY(e[0])-a.scaleY(e[1])}).attr("width",a.scaleX.bandwidth()),l.exit().remove(),i.exit().remove(),{}},p=function(e){if(!e.data.lineData.length)return e.container.select(".line-group").selectAll("path.line").remove(),{};var a=t.line().defined(function(e){return null!=e.value}).x(function(t){return e.lineScaleX(t.timestamp)}).y(function(t){return e.scaleY(t.value)}),n=[],r=e.data.lineData[0].value.length;if("undefined"==typeof r)n.push(e.data.lineData);else for(var i=0;r>i;i++){var l=e.data.lineData.map(function(e){return{timestamp:e.timestamp,value:e.value[i],id:e.id&&e.id[i],className:e.className&&e.className[i]}});n.push(l)}var s=e.container.select(".line-group").selectAll("path.line").data(n);return s.enter().append("path").style("fill","none").merge(s).attr("class",function(e,t){return["line","layer"+t,e[0].id,e[0].className].join(" ")}).attr("d",a),s.exit().remove(),{}},g=function(e){if(!e.data.lineData.length)return e.container.select(".dot-group").selectAll(".dot-layer").remove(),{};for(var t=e.data.lineData,a=[],n=t[0].value.length,r=0;n>r;r++){var i=[];t.forEach(function(e,a){var n=Math.max(0,a-1),l=Math.min(t.length-1,a+1),s=a,c=t[n].value[r],o=t[l].value[r],u=e.value[r];(null!==u&&(null===c||null===o)||s===n&&s===l)&&i.push({value:u,timestamp:e.timestamp,
layer:r})}),a.push(i)}var l=e.container.select(".dot-group").selectAll(".dot-layer").data(a),s=l.enter().append("g").merge(l).attr("class","dot-layer");l.exit().remove();var c=s.selectAll(".dot").data(function(e,t){return e});return c.enter().append("circle").merge(c).attr("class",function(e,t,a){return["dot","layer"+e.layer].join(" ")}).attr("cx",function(t){return e.lineScaleX(t.timestamp)}).attr("cy",function(t){return e.scaleY(t.value)}).attr("r",2),c.exit().remove(),{}},x=function(e){var t=e.container.select(".threshold-line-group").selectAll("line.threshold-line").data(e.data.thresholdData);return t.enter().append("line").merge(t).attr("class",function(e){return["threshold-line",e.id,e.className].join(" ")}).attr("x1",0).attr("y1",function(t){return e.scaleY(t.value)||0}).attr("x2",e.chartWidth).attr("y2",function(t){return e.scaleY(t.value)||0}).attr("display",function(e){return e?null:"none"}),t.exit().remove(),{}},b=function(e){if(!e.data.areaData||!e.data.areaData.length)return e.container.select(".area-group").selectAll("path.area").remove(),{};var a=t.area().defined(function(e){return null!=e.value}).x(function(t){return e.lineScaleX(t.timestamp)}).y0(e.chartHeight).y1(function(t){return e.scaleY(t.value)}),n=e.container.select(".area-group").selectAll("path.area").data([e.data.areaData]);return n.enter().append("path").attr("class",function(e,t){return["area","layer"+t,e[0].id,e[0].className].join(" ")}).merge(n).attr("d",a),n.exit().remove(),{}},y=function(a){if(!a.data.stackedAreaData||!a.data.stackedAreaData.length)return a.container.select(".stacked-area-group").selectAll("g.stack-area").remove(),{};var n=a.data.stackedAreaData[0].value.map(function(e,t){return"y"+t}),r=t.area().defined(function(e){return!Number.isNaN(e[0])&&!Number.isNaN(e[1])}).x(function(e){return a.lineScaleX(e.data.timestamp)}).y0(function(e){return a.scaleY(e[0])}).y1(function(e){return a.scaleY(e[1])}),i=[];a.data.stackedAreaData.forEach(function(t,a){var n=e.utils.mergeAll({},t);t.value&&t.value.length&&(t.value.forEach(function(e,t){n["y"+t]=e}),i.push(n))});var l=a.container.select(".stacked-area-group").selectAll("g.stack-area").data(t.stack().keys(n)(i)),s=l.enter().append("g").attr("class","stack-area").merge(l).selectAll("path.stacked-area").data(function(e,t){return e.forEach(function(t){t.index=e.index}),[e]});return s.enter().append("path").merge(s).attr("class",function(e){var t=e[0].data.id?e[0].data.id[e.index]:null,a=e[0].data.className?e[0].data.className[e.index]:null;return["stacked-area","layer"+e.index,t,a].join(" ")}).attr("d",r),s.exit().remove(),l.exit().remove(),{}},w=function(e){if(e.showStripes===!1)return e.container.select(".stripe-group").selectAll("rect.stripe").remove(),{};var t=e.container.select(".stripe-group").selectAll("rect.stripe").data(e.data.timestamp);return t.enter().append("rect").attr("class","stripe").merge(t).classed("even",function(e,t){return t%2}).attr("x",function(t,a){return e.stripeScaleX(t)||0}).attr("y",function(e){return 0}).attr("width",function(t){return e.stripeScaleX.bandwidth()}).attr("height",function(t){return e.chartHeight}),t.exit().remove(),{}},A=function(e){var a=e.activeDate&&void 0!==e.activeDate.getTime?e.activeDate.getTime():new Date(e.activeDate).getTime(),n=e.data.timestamp.filter(function(e){return e.getTime()===a}),r=e.container.select(".active-group").selectAll("rect.active").data(n);return r.enter().append("rect").attr("class","active").merge(r).each(function(a){if(!e.dataIsEmpty){var n=u(a,e.data);e.events.call("active",null,{timestamp:a,data:n,config:e,event:t.event})}}).attr("x",function(t,a){return e.stripeScaleX(t)||0}).attr("y",function(e){return 0}).attr("width",function(t){return e.stripeScaleX.bandwidth()}).attr("height",function(t){return e.chartHeight}),r.exit().remove(),{}},D=e.utils.pipeline(e.common.defaultConfig,i,a,l,s,d,e.common.axisX,e.common.axisY,w,A,b,v,f,y,m,h,p,g,x,e.common.axisComponentY,e.common.labelsRewriterY,e.common.message,e.common.axisComponentX,e.common.axisTitleComponentX,e.common.axisTitleComponentY,e.common.chartTitleComponent),M=function(a){var n,r,i=t.dispatch("hover","click","mouseout","active"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){n.width=n.parent.clientWidth,c()},200);t.select(window).on("resize."+l,s);var c=function(){r=D(n)},o=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return n=e.utils.mergeAll({},n),n.data=a,c(),this},u=function(t){return n=e.utils.mergeAll(n,t),c(),this},d=function(t,a){u(e.utils.mergeAll(t,{events:a}))},m=function(){t.select(window).on("resize."+l,null),n.parent.innerHTML=null};return d(a,i),{on:e.utils.rebind(i),setConfig:u,setData:o,destroy:m}};e.multiChart=M}(a,n.d3),!function(e,t){var a=function(a){var n=a.parent.querySelector(".datahub-table-chart");if(!n){var r='<div class="datahub-table-chart"><div class="table-container"><div class="header"><div class="row"></div></div><div class="content"></div><div class="footer"><div class="row"></div></div></div><div class="chart-container"><div class="header"><div class="row"></div></div><div class="content"><div class="rows"></div><div class="chart"><svg><g class="panel"><g class="stripes"></g><g class="bars"></g><g class="axis"></g><g class="message-group"></g></g></svg></div></div><div class="footer"><div class="row"></div></div></div></div>';n=e.utils.appendHtmlToNode(r,a.parent)}var i=!(a.elements&&a.elements.length),l={top:0,bottom:24,right:24,left:24},s=a.margin||l,c=a.rowHeight||48,o=t.select(n),u=o.select(".chart-container"),d=u.node().clientWidth,m=d-s.left-s.right,h=i?c:a.elements.length*c+s.bottom,v=h-s.bottom;return{container:o,width:d,height:h,chartWidth:m,chartHeight:v,rowHeight:c,margin:s,dataIsEmpty:i}},n=function(e){if(e.elements){var t=e.elements.slice(),a=t.sort(e.sortFunc);return{elements:a}}return{}},r=function(e){var a=e.domain||[0,0];if(!e.domain&&e.elements){var n=t.merge(e.elements).filter(function(t){return t.key===e.valueKey||t.key===e.referenceKey}).map(function(e){return e.value});a=n.length?t.extent(n):[0,0]}a[0]=Math.min(a[0],0);var r=Math.max(Math.abs(a[0]),Math.abs(a[1]));a=[-r,r];var i=t.scaleLinear().domain(a).range([0,e.chartWidth]);return{scaleX:i}},i=function(e){var a=e.axisXFormat||".2s",n=t.axisBottom().scale(e.scaleX).tickFormat(t.format(a)),r=e.container.select(".axis").attr("transform","translate("+[0,e.chartHeight]+")").attr("display",e.dataIsEmpty?"none":"block").call(n);return{axisX:r}},l=function(e){var t=e.container.select(".header .row").selectAll("div.column").data(e.header||[]);return t.enter().append("div").merge(t).attr("class",function(e){return"column "+e.key}).html(function(e){if(Array.isArray(e.label)){var t=e.label.map(function(e,t){return"<div>"+e+"</div>"}).join("");return'<div class="multiline">'+t+"</div>"}return e.label}),t.exit().remove(),{}},s=function(e){var t=e.container.select(".table-container .content").selectAll("div.row").data(e.elements||[]),a=t.enter().append("div").merge(t).attr("class","row");t.exit().remove();var n=a.selectAll("div.column").data(function(e){return e});n.enter().append("div").merge(n).attr("class","column").html(function(t){if("number"==typeof t.label){var a=function(e){return Math.floor(100*e)/100},n=e.valueFormat||a;return n(t.label)}if(Array.isArray(t.label)){var r=t.label.map(function(e,t){return"<div>"+e+"</div>"}).join("");return'<div class="multiline">'+r+"</div>"}return null===t.label||"undefined"==typeof t.label?e.emptyPlaceholder||"":t.label}),n.exit().remove();var r=e.container.select(".chart-container .rows").selectAll("div.row").data(e.elements||[]);return r.enter().append("div").attr("class","row").append("div").attr("class","column"),r.exit().remove(),{}},c=function(e){var t=e.container.select("svg").attr("width",e.width).attr("height",e.height).select(".panel").attr("transform","translate("+e.margin.left+" 0)").select(".bars").selectAll("g.bar-group").data(e.elements||[]),a=t.enter().append("g").merge(t).attr("class","bar-group").attr("transform",function(t,a){return"translate(0 "+a*e.rowHeight+")"});t.exit().remove();var n=a.selectAll("rect.reference-bar").data(function(t,a){var n=t.filter(function(t){return t.key===e.referenceKey});return[n&&n[0]]});n.enter().append("rect").merge(n).attr("class","reference-bar").attr("width",function(t){return Math.abs(e.scaleX(t.value)-e.scaleX(0))}).attr("height",function(t){return e.rowHeight/2}).attr("x",function(t){return t.value<0?e.scaleX(t.value):e.scaleX(0)}).attr("y",function(t){return e.rowHeight/4}),n.exit().remove();var r=2,i=a.selectAll("rect.reference-line").data(function(t,a){var n=t.filter(function(t){return t.key===e.referenceKey});return[n&&n[0]]});i.enter().append("rect").merge(i).attr("class","reference-line").attr("display",function(e){return e.value||0===e.value?"block":"none"}).attr("width",r).attr("height",function(t){return e.rowHeight/2}).attr("x",function(t){var a=r;return t.value>0&&(a*=-1),e.scaleX(t.value)+a}).attr("y",function(t){return e.rowHeight/4}),i.exit().remove();var l=a.selectAll("rect.value-bar").data(function(t,a){var n=t.filter(function(t){return t.key===e.valueKey});return[n&&n[0]]});return l.enter().append("rect").merge(l).attr("class","value-bar").attr("width",function(t){return Math.abs(e.scaleX(t.value)-e.scaleX(0))}).attr("height",function(t){return e.rowHeight/4}).attr("x",function(t){return t.value<0?e.scaleX(t.value):e.scaleX(0)}).attr("y",function(t){return 3*e.rowHeight/8}),l.exit().remove(),{}},o=function(e){return e.container.on("click",function(){e.events.call("click",null,{event:t.event})}),{}},u=function(e){var t=e.scaleX.ticks(),a=e.container.select(".stripes").selectAll("rect.stripe").data(t);return a.enter().append("rect").attr("class","stripe").merge(a).attr("x",function(a,n){var r=t[Math.max(n-1,0)],i=(e.scaleX(a)-e.scaleX(r))/2;return e.scaleX(a)-i}).attr("y",function(e){return 0}).attr("width",function(a,n){var r=t[Math.max(n-1,0)],i=(e.scaleX(a)-e.scaleX(r))/2;return i=Math.max(i,0)}).attr("height",function(t){return e.chartHeight}),a.exit().remove(),{}},d=function(e){var t=(e.scaleX.ticks(),e.container.select(".stripes").selectAll("line.grid").data([0]));return t.enter().append("line").attr("class","grid").merge(t).attr("display",e.dataIsEmpty?"none":"block").attr("x1",function(t){return e.scaleX(0)+.5}).attr("y1",0).attr("x2",function(t){return e.scaleX(0)+.5}).attr("y2",e.chartHeight),t.exit().remove(),{}},m=function(e){return e.labelsRewriterX?(e.container.selectAll(".axis").selectAll("text").html(function(t,a){return e.labelsRewriterX(t,a,e)}),{}):{}},h=e.utils.pipeline(a,n,l,s,r,o,u,d,i,m,c),v=function(a){var n,r,i=t.dispatch("click"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){n.width=n.parent.clientWidth,c()},200);t.select(window).on("resize."+l,s);var c=function(){r=h(n)},o=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return n=e.utils.mergeAll({},n,{data:a}),c(),this},u=function(t){return n=e.utils.mergeAll(n,t),c(),this},d=function(t,a){u(e.utils.mergeAll(t,{events:a}))},m=function(){t.select(window).on("resize."+l,null),n.parent.innerHTML=null};return d(a,i),{on:e.utils.rebind(i),setConfig:u,setData:o,destroy:m}};e.tableChart=v}(a,n.d3),!function(e,t){var a=function(a){var n=a.parent.querySelector(".datahub-vertical-chart");if(!n){var r='<div class="datahub-vertical-chart"><div class="header"></div><div class="chart-container"><div class="chart-wrapper"><svg><g class="panel"><g class="reference-bars"></g><g class="bars"></g><g class="axis"></g></g></svg></div></div><div class="number-container"></div></div>';n=e.utils.appendHtmlToNode(r,a.parent)}var i=!(a.elements&&a.elements.length),l=t.select(n),s=l.select(".chart-container"),c=s.node().clientWidth,o=26,u=i?0:a.elements.length*o;return{container:l,chartWidth:c,chartHeight:u,rowHeight:o,dataIsEmpty:i,refernceValue:100}},n=function(e){var a=t.scaleLinear().domain([0,100]).range([0,e.referenceBarSize]);return{scaleX:a}},r=function(e){return e.container.select(".header").html(e.title),{}},i=function(e){var t=e.container.select(".number-container").selectAll(".number").data(e.elements||[]),a=t.enter().append("div").merge(t).attr("class",function(e,t){return"number number"+t});t.exit().remove();var n=a.selectAll(".label").data(function(e){return[e]});n.enter().append("div").attr("class","label").merge(n).html(function(e){return e.label}),n.exit().remove();var r=a.selectAll(".value").data(function(e){return[e]});return r.enter().append("div").attr("class","value").merge(r).html(function(t){return Math.round(t.value)+" "+e.unit}),r.exit().remove(),{}},l=function(e){var t=e.container.select("svg").attr("width",e.chartWidth).attr("height",e.chartHeight).select(".panel"),a=e.rowHeight,n=a-2,r=n/2,i=t.select(".bars").selectAll(".bar").data(e.elements||[]);i.enter().append("rect").merge(i).attr("class",function(e,t){return["bar",e.label.toLowerCase(),"bar"+t].join(" ")}).attr("x",function(t){var a=e.scaleX(t.value);return 0>a?e.chartWidth/2-Math.abs(a):e.chartWidth/2}).attr("y",function(e,t){return a*t+(a-r)/2}).attr("width",function(t){return t.value?Math.abs(e.scaleX(t.value)):void 0}).attr("height",r),i.exit().remove();var l=t.select(".reference-bars").selectAll(".bar").data(e.elements||[]);l.enter().append("rect").attr("class","bar").merge(l).attr("x",e.chartWidth/2).attr("y",function(e,t){return a*t+(a-n)/2}).attr("width",function(t,a){return e.referenceBarSize}).attr("height",n),l.exit().remove();var s=t.select(".reference-bars").selectAll(".line").data(e.elements||[]);return s.enter().append("line").attr("class","line").merge(s).attr("x1",e.chartWidth/2+e.referenceBarSize).attr("y1",function(e,t){return a*t+(a-n)/2}).attr("x2",e.chartWidth/2+e.referenceBarSize).attr("y2",function(e,t){return a*t+(a-n)/2+n}),s.exit().remove(),{}},s=function(e){var t=e.container.select(".axis").selectAll(".vertical").data([0]);return t.enter().append("line").attr("class","vertical").merge(t).attr("x1",e.chartWidth/2).attr("y1",0).attr("x2",e.chartWidth/2).attr("y2",e.chartHeight),t.exit().remove(),{}},c=e.utils.pipeline(a,r,i,n,s,l),o=function(a){var n,r,i=t.dispatch("barHover"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){n.width=n.parent.clientWidth,o()},200);t.select(window).on("resize."+l,s);var o=function(){r=c(n)},u=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return n=e.utils.mergeAll({},n,{data:a}),o(),this},d=function(t){return n=e.utils.mergeAll(n,t),o(),this},m=function(t,a){d(e.utils.mergeAll(t,{events:a}))},h=function(){t.select(window).on("resize."+l,null),n.parent.innerHTML=null};return m(a,i),{on:e.utils.rebind(i),setConfig:d,setData:u,destroy:h}};e.verticalChart=o}(a,n.d3),!function(e,t){var a=function(a){var n=a.parent.querySelector(".datahub-waterfall-chart");if(!n){var r='<div class="datahub-waterfall-chart"><div class="chart-container"><svg><g class="panel"><g class="bars"></g><g class="connectors"></g></g></svg></div><div class="number-container"></div></div>';n=e.utils.appendHtmlToNode(r,a.parent)}var i=!(a.elements&&a.elements.length),l=!(!i&&a.elements[0].value),s=t.select(n),c=s.select(".chart-container"),o=a.width||c.node().clientWidth,u=a.height||c.node().clientHeight||300,d=[1,3],m=[1];return{container:s,chartWidth:o,chartHeight:u,dataIsEmpty:l,infoIsEmpty:i,elements:a.elements||[],isConnected:d,isNegative:m}},n=function(e){var a=t.scaleBand().domain(t.range(e.elements.length)).rangeRound([0,e.chartWidth]).paddingInner(.4).paddingOuter(.2);return{scaleX:a}},r=function(e){var a=e.elements.map(function(e){return e.value}),n=t.scaleLinear().domain([0,t.max(a)]).range([0,e.chartHeight]);return{scaleY:n}},i=function(e){var t=e.container.select("svg").attr("width",e.chartWidth).attr("height",e.chartHeight).select(".panel");if(e.dataIsEmpty)return t.select(".bars").selectAll(".bar").remove(),{};var a=t.select(".bars").selectAll(".bar").data(e.elements);return a.enter().append("rect").merge(a).attr("class",function(e,t){return["bar",e.label.toLowerCase(),e.key,"bar"+t].join(" ")}).attr("x",function(t,a){return e.scaleX(a)}).attr("y",function(t,a){var n=e.isConnected.indexOf(a)>-1;if(n){var r=Math.max(0,a-1),i=e.elements[r];return e.isNegative.indexOf(a)>-1?e.chartHeight-e.scaleY(Math.abs(i.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}).attr("width",function(t){return t.value?e.scaleX.bandwidth():void 0}).attr("height",function(t){return e.scaleY(Math.abs(t.value))}),a.exit().remove(),{}},l=function(e){if(e.dataIsEmpty)return e.container.select(".connectors").selectAll(".connector").remove(),{};var t=e.container.select(".connectors").selectAll(".connector").data(e.elements);t.enter().append("line").attr("class","connector").merge(t).attr("x1",function(t,a){return e.scaleX(a)}).attr("y1",function(t,a){var n=e.isConnected.indexOf(a)>-1;if(n){var r=Math.max(0,a-1),i=e.elements[r];return e.isNegative.indexOf(a)>-1?e.scaleY(Math.abs(t.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}).attr("x2",function(t,a){return e.scaleX(Math.min(a+1,e.elements.length-1))}).attr("y2",function(t,a){var n=e.isConnected.indexOf(a)>-1;if(n){var r=Math.max(0,a-1),i=e.elements[r];return e.isNegative.indexOf(a)>-1?e.chartHeight-e.scaleY(Math.abs(i.value))+e.scaleY(Math.abs(t.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}),t.exit().remove();var t=e.container.select(".connectors").selectAll(".base").data([0]);return t.enter().append("line").attr("class","base").merge(t).attr("x1",e.scaleX(0)).attr("y1",e.chartHeight).attr("x2",e.scaleX(Math.max(e.elements.length-1,0))+e.scaleX.bandwidth()||0).attr("y2",e.chartHeight),t.exit().remove(),{}},s=function(e){var t=e.container.select(".number-container").selectAll(".number").data(e.elements),a=t.enter().append("div").merge(t).attr("class",function(e,t){return"number number"+t});t.exit().remove();var n=a.selectAll(".label").data(function(e){return[e]});n.enter().append("div").attr("class","label").merge(n).html(function(e){return e.label}),n.exit().remove();var r=a.selectAll(".value").data(function(e){return[e]});return r.enter().append("div").attr("class","value").merge(r).html(function(e){return"undefined"==typeof e.value?'<div class="error">(Data Unavailable)</div>':Math.round(e.value)}),r.exit().remove(),{}},c=e.utils.pipeline(a,n,r,i,l,s),o=function(a){var n,r,i=t.dispatch("barHover"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){n.width=n.parent.clientWidth,o()},200);t.select(window).on("resize."+l,s);var o=function(){r=c(n)},u=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return n=e.utils.mergeAll({},n,{data:a}),o(),this},d=function(t){return n=e.utils.mergeAll(n,t),o(),this},m=function(t,a){d(e.utils.mergeAll(t,{events:a}))},h=function(){t.select(window).on("resize."+l,null),n.parent.innerHTML=null};return m(a,i),{on:e.utils.rebind(i),setConfig:d,setData:u,destroy:h}};e.waterfallChart=o}(a,n.d3);var a=e="object"==typeof e?e:{},n="object"==typeof t?t:window;"object"==typeof module&&module.exports?n.d3=require("d3"):n.d3=n.d3,"object"==typeof module&&module.exports&&(module.exports=e),t.datahub=e}({},function(){return this}());