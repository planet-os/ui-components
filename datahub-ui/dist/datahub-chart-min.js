!function(e,t){var a=e="object"==typeof e?e:{},r="object"==typeof t?t:window;"object"==typeof module&&module.exports?r.d3=require("d3"):r.d3=r.d3,!function(e){var t=function(e,a){for(var r in a)a[r]&&a[r].constructor==Object&&e[r]?t(e[r],a[r]):e[r]=a[r]},a=function(){for(var e={},a=arguments,r=0;r<a.length;r++)t(e,a[r]);return e},r=function(e,t){for(;t.lastChild;)t.removeChild(t.lastChild);return n(e,t)},n=function(e,t){return t.appendChild(document.importNode((new DOMParser).parseFromString(e,"text/html").body.childNodes[0],!0))},i=function(e,t){var a;return function(){return e&&(a=e.apply(t||this,arguments),e=null),a}},l=function(e,t){var a=!1,r=null;return function(){var n=this;a||(a=!0,clearTimeout(r),r=setTimeout(function(){a=!1,e.apply(n,arguments)},t))}},s=function(e,t){var a,r,n,i,l=[],s=[],c=Number.MAX_VALUE,o=Number.MIN_VALUE,u={};for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)r=t?t(a[i]):a[i],l.push(r),u.hasOwnProperty(r)||null===r||(u[r]=1,r>o&&(o=r),c>r&&(c=r));return s=Object.keys(u).map(function(e,t){return+e}),{flattened:l,uniques:s,max:o,min:c}},c=function(e,t){return s(e,t).uniques},o=function(e,t){return s(e,t).flattened},u=function(e,t,a){for(var r,n=0,i=e.length-1;i>n;)r=n+i>>1,a&&t>=e[r]||!a&&t<e[r]?i=r:n=r+1;return n},d=function(e,t){return u(e,t,!0)},m=function(e){var t,a=0,r=e.length;for(t=0;r>t;t++)e[t]>a&&(a=e[t]);return a},h=function(e){var t,a=1/0,r=e.length;for(t=0;r>t;t++)e[t]<a&&(a=e[t]);return a},v=function(e){return e.slice(4).slice(0,-1).split(",").map(function(e,t){return parseInt(e)})},f=function(){var e=arguments,t=this;return function(a){for(var r=0;r<e.length;r++){var n=e[r].call(this,a);a=t.mergeAll(a,n)}return a}},p=function(e,t){for(var a in t)a in e&&(e[a]=t[a])},g=function(e){return function(){return e.on.apply(e,arguments),this}};e.utils={merge:t,mergeAll:a,htmlToNode:r,appendHtmlToNode:n,once:i,throttle:l,arrayStats:s,arrayUniques:c,arrayFlatten:o,bisection:u,bisectionReversed:d,findMax:m,findMin:h,parseRGB:v,pipeline:f,override:p,rebind:g}}(a),!function(e,t){var a=function(e){var a=t.utcFormat("%b %e, %Y at %H:%M UTC"),r="";if(!e.dataIsEmpty){var n=function(e){return e%1?~~(100*e)/100:e},i=[],l=t.extent(e.timestamps),s=l[0],c=l[1];s.getTime()===c.getTime()&&s.getUTCMonth()===c.getUTCMonth()||i.push("%b %e"),s.getYear()!==c.getYear()&&i.push("%Y"),s.getYear()===c.getYear()&&s.getUTCHours()!==c.getUTCHours()&&i.push("%H:%M"),r=t.utcFormat(i.join(" "))}return{axisXFormat:r,axisTitleXFormat:function(e){return a(e.data.x)},tooltipFormat:function(e){return n(e.data.y)}}},r=function(e){var t={top:50,right:50,bottom:100,left:50};return{margin:e.margin||t,width:e.width||600,height:e.height||300}},n=function(e){return e.dataConverted.sort(function(e,t){var a=e.x.getTime(),r=t.x.getTime();return r>a?-1:a>r?1:0}),{}},i=function(e){var t=!e.flattenedData.filter(function(e){return null!=e.y}).length;return{dataIsAllNulls:t}},l=function(e){var a=e.axisXFormat||"%b",r=t.utcFormat(a)||function(e){return e.toString()},n=t.axisBottom().scale(e.scaleX).tickFormat(r);return{axisX:n}},s=function(e){var a=e.axisYFormat||".2s",r=t.format(a),n=e.scaleY.range()[0],i=t.axisLeft().scale(e.scaleY).ticks(Math.max(~~(n/30),2)).tickPadding(10).tickFormat(r).tickSize(-e.chartWidth);return{axisY:i}},c=function(e){var a=e.container.selectAll("g.axis.x").data([0]),r=a.enter().append("g").attr("class","x axis").attr("transform","translate("+[0,e.chartHeight]+")").merge(a).attr("display",function(t){return e.dataIsEmpty?"none":null}).attr("transform","translate("+[0,e.chartHeight]+")");r.call(e.axisX),a.exit().remove();var n=[],i=(r.selectAll(".tick").select("text").each(function(e,t){var a=this.getBBox().width;a&&n.push(a)}),Math.floor(t.max(n)/e.stripeScaleX.bandwidth()));return i&&r.selectAll(".tick text").attr("display",function(e,t){return t%(i+1)?"none":"block"}),{}},o=function(e){var t=e.axisYPadding||0,a=e.container.selectAll("g.axis.y").data([0]);return a.enter().append("g").attr("class","y axis").attr("transform","translate("+[-t/2,0]+")").merge(a).call(e.axisY).attr("text-anchor","start").selectAll("text").attr("dx",-e.margin.left+10),a.exit().remove(),{}},u=function(e){var t=e.container.selectAll("text.axis-title.x").data([0]);return t.enter().append("text").attr("class","x axis-title").merge(t).text(e.axisTitleX||"").attr("x",e.chartWidth).attr("y",e.chartHeight),t.exit().remove(),{axisTitleXComponent:l}},d=function(e){var t=e.container.selectAll("text.axis-title.y").data([0]);t.enter().append("text").attr("class","y axis-title").merge(t).text(e.axisTitleY||"").attr("x",-e.margin.left).attr("y",-10).attr("text-anchor","start");return t.exit().remove(),{}},m=function(e){var t=e.container.selectAll("text.chart-title").data([e.chartTitle||""]);return t.enter().append("text").attr("class","chart-title").merge(t).html(function(e){return e}).attr("x",function(t){return(e.chartWidth-5*t.length)/2}).attr("y",-5),t.exit().remove(),{}},h=function(e){var t=e.container.selectAll("g.shapes").data([0]),a=t.enter().append("g").attr("class","shapes").merge(t);return t.exit().remove(),{shapePanel:a}},v=function(e){var a=t.select(e.parent).selectAll("div.widget-container").data([0]),r=a.enter().append("div").attr("class","widget-container").merge(a).attr("width",e.width).attr("height",e.height);return a.exit().remove(),{container:r}},f=function(e){var t=v(e).container,a=t.selectAll("svg").data([0]),r=a.enter().append("svg").attr("class","datahub-chart"),n=r.append("g").attr("class","panel").merge(a).attr("transform","translate("+e.margin.left+","+e.margin.top+")");return r.merge(a).attr("width",e.width).attr("height",e.height),a.exit().remove(),{root:a,container:n}},p=function(e){var t="";e.dataIsEmpty?t="(Data Unavailable)":e.dataIsAllNulls&&(t="Values are all null");var a=e.container.select(".message-group").selectAll("text").data([t]);return a.enter().append("text").merge(a).attr("x",(e.scaleX.range()[1]-e.scaleX.range()[0])/2).attr("y",function(){return e.height/2-this.getBBox().height/2}).text(function(e){return e}).attr("dx",function(e){return-this.getBBox().width/2}),a.exit().remove(),{}},g=function(e){return e.container.select("g.axis.x").selectAll(".tick text").text(function(e){return t.timeFormat("%a")(e)}),{}},x=function(e){return e.container.select("g.axis.x").selectAll(".tick text").text(function(e){return t.timeFormat("%x")(e)}),{}},b=function(e){return e.container.select("g.axis.x").selectAll(".tick text").style("transform","rotate(30deg)").style("text-anchor","start"),{}},y=function(e){return config.axisY.tickFormat(t.format(".2s")),{}},w=function(e){return e.labelsRewriterY?(e.container.selectAll("g.axis.y").selectAll("text").html(function(t,a){return e.labelsRewriterY(t,a,e)}),{}):{}};e.common={axesFormatAutoconfig:a,defaultConfig:r,sortData:n,detectDataAllNulls:i,axisX:l,axisY:s,axisComponentX:c,axisComponentY:o,axisTitleComponentX:u,axisTitleComponentY:d,chartTitleComponent:m,shapePanel:h,svgContainer:f,container:v,message:p,axisXFormatterTime:g,axisXFormatterTimeHour:x,axisXFormatterRotate30:b,axisYFormatSI:y,labelsRewriterY:w}}(a,r.d3),!function(e,t){function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(e){if(e)return!0;throw"You need to set an API key using `datahub.data.setApiKey(API_KEY)`. You can get yours at http://data.planetos.com/"}var n={currentBaseURI:"https://data.planetos.com/",baseURI:"https://api.planetos.com/v1a/",datasetsEndpoint:"https://api.planetos.com/v1/datasets/",apiKey:null},i=function(e){return n.apiKey=e,this},l=function(){return{type:"Feature",properties:{name:""},geometry:{type:"LineString",coordinates:[[-170,80],[170,80],[170,-80],[-170,-80],[-170,80]]}}},s=function(){var e=d(50,function(e,t){return{coordinates:[360*Math.random()-180,180*Math.random()-90],id:"random-point-"+t}});return c(e)},c=function(e){return{type:"FeatureCollection",features:e.map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e.coordinates},properties:{id:e.id}}})}},o=function(e){var t="https://cdn.rawgit.com/johan/world.geo.json/master/countries.geo.json";v(t,function(t,a){e(a)})},u=function(){var t={lon:d(360,function(e,t){return t-180}),lat:d(180,function(e,t){return 180-t-90}),values:d(180,function(e,t){return d(360,function(e,t){return~~(100*Math.random())})})};return t.uniqueValues=e.utils.arrayUniques(t.values),t},d=function(e,t){var a=t||function(e,t){return 0};return Array.apply(null,Array(e)).map(a)},m=function(e){var e=e||{},t={count:e.count||12,layerCount:e.layerCount||1,timeStart:e.timeStart||"2016-01-01",timeIncrement:e.timeIncrement||"month",step:e.step||1,min:e.min||0,max:e.max||100},a=~~(Math.random()*(t.max-t.min))+t.min,r=d(t.count,function(){return d(t.layerCount,function(e){return a+=(2*Math.random()-1)*((t.max-t.min)/10),a=Math.max(a,t.min)})}),n=h(t),i=n.map(function(e,t){return{timestamp:e,value:r[t],id:r[t].map(function(e){return~~(1e3*Math.random())}),className:r[t].map(function(e){return Math.random().toString(36).substring(4,8)})}});return i},h=function(e){var e=e||{},r={count:e.count||12,layerCount:e.layerCount||1,timeStart:e.timeStart||"2016-01-01",timeIncrement:e.timeIncrement||"month",step:e.step||1,min:e.min||0,max:e.max||100},n="utc"+a(r.timeIncrement)||"utcHour",i=t[n],l=t[n+"s"],s=r.timeStart?new Date(r.timeStart):new Date,c=i.offset(s,r.count*r.step),o=l(s,c,r.step),u=o.map(function(e,a){return t.isoFormat(e)});return u},v=function(e,t){var a="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("get",e,!0),a.onreadystatechange=function(){var e,r;4==a.readyState&&(e=a.status,200==e?(r=JSON.parse(a.responseText),t(null,r)):t(e))},a.send()},f=function(e,t){r(n.apiKey);var a=n.baseURI+"/datasets/"+e+"?apikey="+n.apiKey;return console.log("get dataset details",a),v(a,function(e,a){if(void 0===a)return console.log("Can not render dataset because of API error",e),!1;var r=a.FeatureType||"timeseries",n="grid"===r.toLowerCase().trim()?"raster":"timeseries";console.log("Data type:",n,a.ProductType,a.FeatureType,a),t({datasetInfo:a,dataType:n,productType:a.ProductType})}),this},p=function(e,t,a){r(n.apiKey);var i=n.baseURI+"/datasets/"+e+"/variables?apikey="+n.apiKey;return console.log("query variables",i),v(i,function(r,n){var i,l=n[e],s=t;s&&(i=l.filter(function(e){return e.name===s})[0]);var c=i||l[0];a({variables:l,defaultVariable:c})}),this},g=function(e,t,a){r(n.apiKey);var i=n.baseURI+"/datasets/"+e+"/variables/"+encodeURIComponent(t)+"/timestamps?apikey="+n.apiKey;return console.log("query timestamps",i),v(i,function(e,t){if(e)return void console.log("Server error",e);var r=t.map(function(e){return new Date(parseInt(e))});a({timestamps:r})}),this},x=function(t,a,i,l){r(n.apiKey);var s=n.baseURI+"/datasets/"+t+"/variables/"+encodeURIComponent(a);return i&&(s+="/timestamps/"+i),s+="/sample_data",s+="?apikey="+n.apiKey,console.log("query dataset",s),v(s,function(r,i){if(r)return void console.log("Server error",r);i.values=i.values.map(function(e,t){return e.map(function(e){return-999===e?null:e})}),i.uniqueValues=e.utils.arrayUniques(i.values).sort();var c=n.currentBaseURI+"/datasets/"+t+"?variable="+a;l({json:i,uri:s,datahubLink:c})}),this},b=function(e,t){r(n.apiKey);var a=n.datasetsEndpoint+e+"/stations?apikey="+n.apiKey;return console.log("get stations",a),v(a,function(e,a){if(e)return void console.log("Server error",e);var r=[];for(var n in a.station){var i=a.station[n];void 0!==i.SpatialExtent&&r.push({id:n,coordinates:i.SpatialExtent.coordinates})}t({stations:r,defaultStation:r[0]})}),this},y=function(e,t,a,i,l){r(n.apiKey);var s=500,c=n.datasetsEndpoint+e+"/stations/"+t+"?apikey="+n.apiKey+"&verbose=true&count="+s;return i||(c+="&time_order=desc"),console.log("station variable",c),v(c,function(t,r){if(t)return void console.log("Server error",t);console.log("Point API data",r,c);var i,s,o={},u=r.metadata.contexts;for(var d in u){i=u[d].dataVariables;for(var m in i)s=i[m],s.key=m,o[m]=s}var h={};r.entries.forEach(function(e){for(var t in e.data)h[t]||(h[t]={values:[],timestamps:[]}),h[t].values.push(e.data[t]),h[t].timestamps.push(new Date(e.axes.time))});var v=[];for(var f in o)v.push(o[f]);var p=n.currentBaseURI+"/datasets/"+e+"?variable="+a;l({datasets:h,variablesMetadata:o,variables:v,datahubLink:p,variableData:h[a],variableMetadata:o[a]})}),this},w=function(e,t,a,i,l){r(n.apiKey);var s=n.baseURI+"/datasets/"+e+"/variables/"+encodeURIComponent(t);return a&&(s+="/timestamps/"+a),s+="/image",s+="?width="+i+"&projection=mercator",s+="&apikey="+n.apiKey,console.log("query image",s),v(s,function(e,t){l(t.img,t.metadata)}),this};e.data={generateRaster:u,generateGeojson:l,generateTimeSeries:m,generateTimestamps:h,getDatasetDetails:f,getVariables:p,getTimestamps:g,getPreview:x,getStations:b,getStationVariables:y,getImage:w,getJSON:v,apiConfig:n,pointsToFeatures:c,generateGeojsonPoints:s,getWorldVector:o,setApiKey:i}}(a,r.d3),!function(e,t){var a=function(e){var a=e.width-e.margin.left-e.margin.right,r=e.timeRange.map(function(e){return new Date(e)}),n=t.scaleTime().domain(r).range([0,a]);return{scaleX:n,sliderWidth:a}},r=function(e){var a=e.height-e.margin.top-e.margin.bottom,r=e.axisXFormat||t.utcFormat("%b"),n=t.axisBottom().scale(e.scaleX).tickFormat(r).tickSize(a-12);return{axisX:n,sliderHeight:a}},n=function(e){var t=e.container.selectAll("g.axis.x").data([0]);return t.enter().append("g").attr("class","x axis").attr("transform","translate("+[0,e.margin.top]+")").merge(t).transition().attr("transform","translate("+[0,e.margin.top]+")").call(e.axisX),t.exit().remove(),{}},i=function(e){e.container.classed("datahub-button-group",!0);var a=t.dispatch("click"),r=e.container.selectAll(".element").data(e.elements),n=r.enter().append("div").on("click",function(t){var r=this,i=!1;n.classed("active",function(){return isAlreadyActive=this.classList.contains("active"),isTarget=r===this,isTarget&&isAlreadyActive&&e.isTogglable!==!1&&(i=!0),e.isExclusive?(!isAlreadyActive||isAlreadyActive&&e.isTogglable===!1)&&isTarget:isTarget?!isAlreadyActive:isAlreadyActive}),a.call("click",null,{selected:i?null:t})}).merge(r).attr("class",function(e){return"element "+(e.className||"")}).classed("active",function(t){return t.key===e.defaultElementKey}).html(function(e){return e.label});return r.exit().remove(),{events:a}},l=function(e){e.container.classed("datahub-slider",!0);var a=t.dispatch("brush"),r=t.brushX().extent([[0,0],[e.sliderWidth,e.sliderHeight-12]]).handleSize(10).on("brush",function(){var r=t.event.selection,n={start:e.scaleX.invert(r[0]),end:e.scaleX.invert(r[1])};a.call("brush",null,{brushExtent:n})}),n=e.container.selectAll("g.brush").data([0]);n.enter().append("g").attr("class","brush").attr("transform","translate("+[0,e.margin.top]+")").merge(n).attr("transform","translate("+[0,e.margin.top]+")").call(r).call(r.move,e.scaleX.range());return n.exit().remove(),e.initialTimeRange,{events:a}},s=function(a){function r(e){return l.title=e||l.title,o.select(".title").html(l.title),this}function n(e){return l.value=e||l.value,o.select(".value").html(l.value),this}function i(e){return l.info=e||l.info,o.select(".info").html(l.info),this}var l={title:a.title,value:a.value,info:a.info},s='<div class="datahub-number"><div class="title"></div><div class="value"></div><div class="info"></div></div>',c=e.utils.appendHtmlToNode(s,a.parent),o=t.select(c).on("click",function(e){u.call("click",null,l)}),u=t.dispatch("click");return r(l.title),n(l.value),i(l.info),{on:e.utils.rebind(u),setTitle:r,setValue:n,setInfo:i}},c=function(a){function r(e){if(!e)return this;o.header=e,o.defaultSortKey=e[0].key;var t=c.select(".header-row").selectAll(".header-cell").data(e),a=t.enter().append("div").attr("class","header-cell").on("click",function(e,t){if(this.classList.contains("sortable")&&o.elements){var r=this,i=!1;a.classed("ascending",function(e){var t=r===this;return t&&(i=this.classList.contains("ascending"),t=!i),t}),n(o.elements,e.key,!i)}}).merge(t).classed("sortable",function(e){return e.sortable}).classed("ascending",function(e){return e.key===o.defaultSortKey}).html(function(e){return e.label});t.exit().remove()}function n(e,t,a){if(!e||!o.header)return this;o.elements=e;var r=t||o.defaultSortKey,n="undefined"==typeof a?!0:a,l=i(e,r,n),s=c.selectAll(".table-row").data(l),u=s.enter().append("div").attr("class","table-row").merge(s);s.exit().remove();var d=u.selectAll(".cell").data(function(e){return e});d.enter().append("div").attr("class","cell").merge(d).html(function(e){return e}),d.exit().remove()}function i(e,t,a){var r=o.header.map(function(e){return e.key}).indexOf(t),n=JSON.parse(JSON.stringify(e)).sort(function(e,t){return e[r]<t[r]?a?-1:1:e[r]>t[r]?a?1:-1:0});return n}var l='<div class="datahub-table"><div class="header-row"></div></div>',s=e.utils.appendHtmlToNode(l,a.parent),c=t.select(s),o={elements:a.elements,header:a.header,defaultSortKey:a.header?a.header[0].key:null};return n(a.elements),r(a.header),{setHeader:r,setElements:n}},o=function(a){function r(e){s.select(".alert-band").classed(e,!0)}function n(e){s.select(".alert-message").html(e)}var i='<div class="datahub-alert-message"><div class="alert-band"></div><div class="alert-message"></div></div>',l=e.utils.appendHtmlToNode(i,a.parent),s=t.select(l);return r(a.level),n(a.message),{setLevel:r,setMessage:n}},u=function(a){function r(){D.text(w.year),l()}function n(){M.classed("active",function(e){return e===w.month}),l()}function i(){A.call("change",null,s()),l()}function l(){A.call("update",null,s())}function s(){return{year:w.year,month:w.month,date:c(),iso:u(),formatted:o()}}function c(){return new Date(w.year,y.indexOf(w.month))}function o(e){var a=e||"%B %Y";return t.timeFormat(a)(c())}function u(e){return t.isoFormat(c())}function d(e){return w={month:y[new Date(e).getMonth()],year:new Date(e).getFullYear()},r(),n(),this}function m(e){return w.month=e,n(),this}function h(e){return w.year=e,r(),this}function v(){return y}function f(e){return w.month=y[e],n(),this}function p(){a.parent.innerHTML=null}var g='<div class="datahub-month-calendar"> <div class="year-selector">     <div class="prev-year">&lsaquo;</div>     <div class="selected-year"></div>     <div class="next-year">&rsaquo;</div> </div> <div class="month-selector"> </div></div>',x=e.utils.appendHtmlToNode(g,a.parent),b=t.select(x),y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],w={month:y[(new Date).getMonth()],year:(new Date).getFullYear()},A=t.dispatch("change","update"),D=b.select(".selected-year").text(w.year);b.select(".prev-year").on("click",function(e){w.year-=1,r(),i()}),b.select(".next-year").on("click",function(e){w.year+=1,r(),i()});var k=b.select(".month-selector").selectAll(".element").data(y),M=k.enter().append("div").attr("class","element month").text(function(e){return e}).on("click",function(e){var t=this;M.classed("active",function(){return t===this}),w.month=e,n(),i()}).merge(k).classed("active",function(e){return e===w.month});return a.defaultMonth&&a.defaultYear?(m(a.defaultMonth),h(a.defaultYear)):a.defaultMonthNumber&&a.defaultYear?(f(a.defaultMonthNumber),h(a.defaultYear)):d(a.defaultDate||new Date),i(),{on:e.utils.rebind(A),getDateFormats:s,getDate:c,getISODate:u,getFormattedDate:o,setDate:d,setMonth:m,setYear:h,getMonthNames:v,setMonthNumber:f,destroy:p}},d=function(a){function r(e){return f.html(e),o&&o.classed("active",function(t){return t.label===e}),this}function n(e){if(!e)return this;var t=h.selectAll(".element").data(e,function(e){return e.key});return o=t.enter().append("div").attr("class","element").on("mouseover",l).on("click",function(e){if(!a.ignoreClickEvents){var t=this;o.classed("active",function(){return t===this}),r(e.label),v.call("change",null,e),s()}}).merge(t).html(function(e){return e.label}),t.exit().remove(),r(a.selected||a.elements[0].label),this}function i(e){return h.classed("active",e),this}function l(){return i(!0),this}function s(){return i(!1),this}function c(){return h.classed("active")}var o,u='<div class="datahub-dropdown"> <div class="top">     <div class="title"></div>     <div class="selected-element"></div> </div> <div class="elements"></div></div>',d=e.utils.appendHtmlToNode(u,a.parent),m=t.select(d),h=m.select(".elements"),v=t.dispatch("change");m.select(".title").html(a.title);var f=m.on("mouseover",function(){var e="ontouchstart"in document.documentElement,t=h.classed("active");t||e||l()}).on("mouseout",function(){var e=h.classed("active"),t="ontouchstart"in document.documentElement;e&&!t&&s()}).select(".top").on("click",function(){var e=h.classed("active");e?s():l()}).select(".selected-element");return n(a.elements),{on:e.utils.rebind(v),toggle:i,open:l,close:s,isOpened:c,setElements:n,setSelected:r}},m=function(a){var r=t.dispatch("change"),n=d({parent:a.parent,ignoreClickEvents:!0}),i=u({parent:a.parent.querySelector(".elements"),defaultDate:a.defaultDate,defaultMonthNumber:a.defaultMonthNumber,defaultYear:a.defaultYear,defaultMonth:a.defaultMonth}).on("change",function(e){r.call("change",null,e)}).on("update",function(e){n.setSelected(e.formatted)});return n.setSelected(i.getFormattedDate()),{on:e.utils.rebind(r),toggle:n.toggle,open:n.open,close:n.close,isOpened:n.isOpened,setElements:n.setElements,setSelected:n.setSelected,getDateFormats:i.getDateFormats,getDate:i.getDate,getISODate:i.getISODate,getFormattedDate:i.getFormattedDate,setDate:i.setDate,setMonth:i.setMonth,setYear:i.setYear,getMonthNames:i.getMonthNames,setMonthNumber:i.setMonthNumber}},l=e.utils.pipeline(a,r,e.common.svgContainer,n,l),h=e.utils.pipeline(e.common.container,i);e.widget={timeSlider:l,buttonGroup:h,number:s,table:c,alertMessage:o,monthCalendar:u,dropdown:d,dropdownCalendar:m}}(a,r.d3),!function(e,t){var a=function(a){var r=a.parent.querySelector(".widget-container");if(!r){var n='<div class="widget-container"><svg class="datahub-chart"><g class="panel"><g class="stripe-group"></g><g class="area-group"></g><g class="stacked-area-group"></g><g class="reference-bar-group"></g><g class="reference-line-group"></g><g class="bar-group"></g><g class="stacked-bar-group"></g><g class="estimate-bar-group"></g><g class="line-group"></g><g class="dot-group"></g><g class="threshold-line-group"></g><g class="y axis"></g><g class="x axis"></g><g class="active-group"></g><g class="title-container"><text class="y axis-title"></text><text class="x axis-title"></text><text class="chart-title"></text></g><g class="message-group"></g><g class="events"><rect class="event-panel"></rect></g></g></svg></div>';r=e.utils.appendHtmlToNode(n,a.parent)}var i=a.width-a.margin.left-a.margin.right,l=a.height-a.margin.top-a.margin.bottom,s=t.select(r);return s.select("svg").attr("width",a.width).attr("height",a.height),s.select(".panel").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),s.select(".events rect").attr("width",i).attr("height",l).attr("opacity",0),{container:s,chartWidth:i,chartHeight:l}},r=function(e,t,a){return e[t]?e[t].map(function(e){return e.timestamp=new Date(e.timestamp),e.value=Array.isArray(e.value)&&!a?e.value[0]:e.value,e}):[]},n=function(e){return e.timestamp?e.timestamp.map(function(e){return new Date(e)}):[]},i=function(e){var t=e.data||{};return{dataIsEmpty:!t||!t.timestamp||!t.timestamp.length,data:{timestamp:n(t),stackedBarData:r(t,"stackedBarData",!0),stackedAreaData:r(t,"stackedAreaData",!0),lineData:r(t,"lineData",!0),barData:r(t,"barData"),referenceData:r(t,"referenceData"),estimateData:r(t,"estimateData"),thresholdData:r(t,"thresholdData"),areaData:r(t,"areaData")}}},l=function(e){var a=e.dataIsEmpty?0:e.data.timestamp,r=t.scaleBand().domain(a).range([0,e.chartWidth]).paddingInner(.4).paddingOuter(.2),n=r.copy().paddingInner(.1).paddingOuter(.05),i=r.copy().paddingInner(0).paddingOuter(0),l=r.copy().paddingInner(1).paddingOuter(.5);return{scaleX:r,referenceScaleX:n,stripeScaleX:i,lineScaleX:l}},s=function(e,a){var r=a?"min":"max";return e?t[r](e.map(function(e){return e.value})):null},c=function(e,a){var r=a?"min":"max";if(e&&e.length){var n=e.map(function(e){return t.sum(e.value)});return t[r](n)}return null},o=function(e,a){var r=a?"min":"max";if(e&&e.length){var n=e.map(function(e,t){return e.value});return n[0].length&&(n=t.merge(n)),t[r](n)}return null},u=function(e){var a=[];a.push(s(e.data.barData)),a.push(s(e.data.referenceData)),a.push(s(e.data.estimateData)),a.push(s(e.data.thresholdData)),a.push(s(e.data.areaData)),a.push(c(e.data.stackedBarData)),a.push(c(e.data.stackedAreaData)),a.push(o(e.data.lineData));var r=[],n=!0;r.push(s(e.data.barData,n)),r.push(s(e.data.referenceData,n)),r.push(s(e.data.estimateData,n)),r.push(s(e.data.thresholdData,n)),r.push(s(e.data.areaData,n)),r.push(c(e.data.stackedBarData,n)),r.push(c(e.data.stackedAreaData,n)),r.push(o(e.data.lineData,n));var i,l=t.max(a);if(e.autoScaleY){i=t.min(r);var u=(l-i)/10;i=Math.max(i-u,0),l+=u}else i=Math.min(t.min(r),0),l=Math.max(l,0);var d=[i,l];e.domain&&(d=e.domain),e.reverseY&&(d=[d[1],d[0]]);var m=t.scaleLinear().domain(d).range([e.chartHeight,0]);return{scaleY:m}},d=function(t,a,r){if(!r)return null;var n=t[a].map(function(e){return e.timestamp&&e.timestamp.getTime()}).indexOf(r.getTime());if(n>-1){var i=e.utils.mergeAll({},t[a][n]);return i.value=[].concat(t[a][n].value),i.id=[].concat(t[a][n].id),i}return null},m=function(t,a,r){if(t[a][0]){var n=e.utils.mergeAll({},t[a][0]);return n.value=[].concat(t[a][0].value),n.id=[].concat(t[a][0].id),n}return null},h=function(e,t){var a={referenceData:d(t,"referenceData",e),estimateData:d(t,"estimateData",e),barData:d(t,"barData",e),stackedBarData:d(t,"stackedBarData",e),lineData:d(t,"lineData",e),areaData:d(t,"areaData",e),stackedAreaData:d(t,"stackedAreaData",e),thresholdData:m(t,"thresholdData",e)};return a},v=function(e){var a=e.container.select(".events .event-panel").on("mousemove touchstart",function(a){if(!e.dataIsEmpty){var r=t.mouse(this)[0],n=e.stripeScaleX.bandwidth(),i=e.stripeScaleX.domain(),l=i.length,s=Math.min(~~(r/n),l-1),c=i[s],o=h(c,e.data);e.events.call("hover",null,{index:s,timestamp:c,data:o,config:e,event:t.event})}}).on("mouseout",function(t){e.events.call("mouseout",null,{})}).on("click",function(a){e.events.call("click",null,{event:t.event})});return{eventPanel:a}},f=function(e){var t=e.container.select(".bar-group").selectAll("rect.bar").data(e.data.barData);return t.enter().append("rect").merge(t).attr("class",function(e){return["bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.scaleX(t.timestamp)||0}).attr("y",function(t){return e.autoScaleY?e.chartHeight-(e.chartHeight-Math.abs(e.scaleY(t.value))):t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)}).attr("width",function(t){return e.scaleX.bandwidth()}).attr("height",function(t){return e.autoScaleY?e.chartHeight-Math.abs(e.scaleY(t.value)):Math.abs(e.scaleY(t.value)-e.scaleY(0))}),t.exit().remove(),{}},p=function(e){var t=e.container.select(".estimate-bar-group").selectAll("rect.estimate-bar").data(e.data.estimateData);return t.enter().append("rect").merge(t).attr("class",function(e){return["estimate-bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.scaleX(t.timestamp)||0}).attr("y",function(t){return e.scaleY(t.value)||0}).attr("width",function(t){return e.scaleX.bandwidth()}).attr("height",function(t){return e.chartHeight-e.scaleY(t.value)||0}),t.exit().remove(),{}},g=function(e){var t=e.container.select(".reference-bar-group").selectAll("rect.reference-bar").data(e.data.referenceData);t.enter().append("rect").merge(t).attr("class",function(e){return["reference-bar",e.id,e.className].join(" ")}).attr("x",function(t,a){return e.referenceScaleX(t.timestamp)||0}).attr("y",function(t){return e.autoScaleY?e.chartHeight-(e.chartHeight-Math.abs(e.scaleY(t.value))):t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)}).attr("width",function(t){return e.referenceScaleX.bandwidth()}).attr("height",function(t){return e.autoScaleY?e.chartHeight-Math.abs(e.scaleY(t.value)):Math.abs(e.scaleY(t.value)-e.scaleY(0))}),t.exit().remove();var a=e.container.select(".reference-line-group").selectAll("path.reference-top").data(e.data.referenceData);return a.enter().append("path").attr("class","reference-top").merge(a).attr("d",function(t,a){var r=e.referenceScaleX(t.timestamp)||0,n=0;n=t.value>=0||e.reverseY?e.scaleY(0)-Math.abs(e.scaleY(t.value)-e.scaleY(0)):e.scaleY(0)+Math.abs(e.scaleY(t.value)-e.scaleY(0));var i=e.referenceScaleX.bandwidth();return"M"+[[r,n],[r+i,n]]}),a.exit().remove(),{}},x=function(a){if(!a.data.stackedBarData||!a.data.stackedBarData.length)return a.container.select(".stacked-bar-group").selectAll("g.stack").remove(),{};var r=a.data.stackedBarData[0].value.map(function(e,t){return"y"+t}),n=[];a.data.stackedBarData.forEach(function(t,a){var r=e.utils.mergeAll({},t);t.value&&t.value.length&&(t.value.forEach(function(e,t){r["y"+t]=e}),n.push(r))});var i=a.container.select(".stacked-bar-group").selectAll("g.stack").data(t.stack().keys(r)(n)),l=i.enter().append("g").attr("class","stack").merge(i).selectAll("rect.stacked-bar").data(function(e,t){return e.forEach(function(t){t.index=e.index}),e});return l.enter().append("rect").attr("class","stacked-bar").merge(l).attr("class",function(e,t,a){var r=e.data.id?e.data.id[e.index]:null,n=e.data.className?e.data.className[e.index]:null;return["stacked-bar","layer"+e.index,r,n].join(" ")}).filter(function(e){return!Number.isNaN(e[0])&&!Number.isNaN(e[1])}).attr("x",function(e){return a.scaleX(e.data.timestamp)}).attr("y",function(e){return a.scaleY(e[1])}).attr("height",function(e){return a.scaleY(e[0])-a.scaleY(e[1])}).attr("width",a.scaleX.bandwidth()),l.exit().remove(),i.exit().remove(),{}},b=function(e){if(!e.data.lineData.length)return e.container.select(".line-group").selectAll("path.line").remove(),{};var a=t.line().defined(function(e){return null!=e.value}).x(function(t){return e.lineScaleX(t.timestamp)}).y(function(t){return e.scaleY(t.value)}),r=[],n=e.data.lineData[0].value.length;if("undefined"==typeof n)r.push(e.data.lineData);else for(var i=0;n>i;i++){var l=e.data.lineData.map(function(e){return{timestamp:e.timestamp,value:e.value[i],id:e.id&&e.id[i],className:e.className&&e.className[i]}});r.push(l)}var s=e.container.select(".line-group").selectAll("path.line").data(r);return s.enter().append("path").style("fill","none").merge(s).attr("class",function(e,t){return["line","layer"+t,e[0].id,e[0].className].join(" ")}).attr("d",a),s.exit().remove(),{}},y=function(e){if(!e.data.lineData.length)return e.container.select(".dot-group").selectAll(".dot-layer").remove(),{};for(var t=e.data.lineData,a=[],r=t[0].value.length,n=0;r>n;n++){var i=[];t.forEach(function(e,a){var r=Math.max(0,a-1),l=Math.min(t.length-1,a+1),s=a,c=t[r].value[n],o=t[l].value[n],u=e.value[n];(null!==u&&(null===c||null===o)||s===r&&s===l)&&i.push({value:u,timestamp:e.timestamp,layer:n})}),a.push(i)}var l=e.container.select(".dot-group").selectAll(".dot-layer").data(a),s=l.enter().append("g").merge(l).attr("class","dot-layer");l.exit().remove();var c=s.selectAll(".dot").data(function(e,t){return e});return c.enter().append("circle").merge(c).attr("class",function(e,t,a){return["dot","layer"+e.layer].join(" ")}).attr("cx",function(t){return e.lineScaleX(t.timestamp)}).attr("cy",function(t){return e.scaleY(t.value)}).attr("r",2),c.exit().remove(),{}},w=function(e){var t=e.container.select(".threshold-line-group").selectAll("line.threshold-line").data(e.data.thresholdData);return t.enter().append("line").merge(t).attr("class",function(e){return["threshold-line",e.id,e.className].join(" ")}).attr("x1",0).attr("y1",function(t){return e.scaleY(t.value)||0}).attr("x2",e.chartWidth).attr("y2",function(t){return e.scaleY(t.value)||0}).attr("display",function(e){return e?null:"none"}),t.exit().remove(),{}},A=function(e){if(!e.data.areaData||!e.data.areaData.length)return e.container.select(".area-group").selectAll("path.area").remove(),
{};var a=t.area().defined(function(e){return null!=e.value}).x(function(t){return e.lineScaleX(t.timestamp)}).y0(e.chartHeight).y1(function(t){return e.scaleY(t.value)}),r=e.container.select(".area-group").selectAll("path.area").data([e.data.areaData]);return r.enter().append("path").attr("class",function(e,t){return["area","layer"+t,e[0].id,e[0].className].join(" ")}).merge(r).attr("d",a),r.exit().remove(),{}},D=function(a){if(!a.data.stackedAreaData||!a.data.stackedAreaData.length)return a.container.select(".stacked-area-group").selectAll("g.stack-area").remove(),{};var r=a.data.stackedAreaData[0].value.map(function(e,t){return"y"+t}),n=t.area().defined(function(e){return!Number.isNaN(e[0])&&!Number.isNaN(e[1])}).x(function(e){return a.lineScaleX(e.data.timestamp)}).y0(function(e){return a.scaleY(e[0])}).y1(function(e){return a.scaleY(e[1])}),i=[];a.data.stackedAreaData.forEach(function(t,a){var r=e.utils.mergeAll({},t);t.value&&t.value.length&&(t.value.forEach(function(e,t){r["y"+t]=e}),i.push(r))});var l=a.container.select(".stacked-area-group").selectAll("g.stack-area").data(t.stack().keys(r)(i)),s=l.enter().append("g").attr("class","stack-area").merge(l).selectAll("path.stacked-area").data(function(e,t){return e.forEach(function(t){t.index=e.index}),[e]});return s.enter().append("path").merge(s).attr("class",function(e){var t=e[0].data.id?e[0].data.id[e.index]:null,a=e[0].data.className?e[0].data.className[e.index]:null;return["stacked-area","layer"+e.index,t,a].join(" ")}).attr("d",n),s.exit().remove(),l.exit().remove(),{}},k=function(e){if(e.showStripes===!1)return e.container.select(".stripe-group").selectAll("rect.stripe").remove(),{};var t=e.container.select(".stripe-group").selectAll("rect.stripe").data(e.data.timestamp);return t.enter().append("rect").attr("class","stripe").merge(t).classed("even",function(e,t){return t%2}).attr("x",function(t,a){return e.stripeScaleX(t)||0}).attr("y",function(e){return 0}).attr("width",function(t){return e.stripeScaleX.bandwidth()}).attr("height",function(t){return e.chartHeight}),t.exit().remove(),{}},M=function(e){var a=e.activeDate&&void 0!==e.activeDate.getTime?e.activeDate.getTime():new Date(e.activeDate).getTime(),r=e.data.timestamp.filter(function(e){return e.getTime()===a}),n=e.container.select(".active-group").selectAll("rect.active").data(r);return n.enter().append("rect").attr("class","active").merge(n).each(function(a){if(!e.dataIsEmpty){var r=h(a,e.data);e.events.call("active",null,{timestamp:a,data:r,config:e,event:t.event})}}).attr("x",function(t,a){return e.stripeScaleX(t)||0}).attr("y",function(e){return 0}).attr("width",function(t){return e.stripeScaleX.bandwidth()}).attr("height",function(t){return e.chartHeight}),n.exit().remove(),{}},Y=e.utils.pipeline(e.common.defaultConfig,i,a,l,u,v,e.common.axisX,e.common.axisY,k,M,A,g,x,D,f,p,b,y,w,e.common.axisComponentY,e.common.labelsRewriterY,e.common.message,e.common.axisComponentX,e.common.axisTitleComponentX,e.common.axisTitleComponentY,e.common.chartTitleComponent),X=function(a){var r,n,i=t.dispatch("hover","click","mouseout","active"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){r.width=r.parent.clientWidth,c()},200);t.select(window).on("resize."+l,s);var c=function(){n=Y(r)},o=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return r=e.utils.mergeAll({},r),r.data=a,c(),this},u=function(t){return r=e.utils.mergeAll(r,t),c(),this},d=function(t,a){u(e.utils.mergeAll(t,{events:a}))},m=function(){t.select(window).on("resize."+l,null),r.parent.innerHTML=null};return d(a,i),{on:e.utils.rebind(i),setConfig:u,setData:o,destroy:m}};e.multiChart=X}(a,r.d3),!function(e,t){var a=function(a){var r=a.parent.querySelector(".datahub-table-chart");if(!r){var n='<div class="datahub-table-chart"><div class="table-container"><div class="header"><div class="row"></div></div><div class="content"></div><div class="footer"><div class="row"></div></div></div><div class="chart-container"><div class="header"><div class="row"></div></div><div class="content"><div class="rows"></div><div class="chart"><svg><g class="panel"><g class="stripes"></g><g class="bars"></g><g class="axis"></g><g class="message-group"></g></g></svg></div></div><div class="footer"><div class="row"></div></div></div></div>';r=e.utils.appendHtmlToNode(n,a.parent)}var i=!(a.elements&&a.elements.length),l={top:0,bottom:24,right:24,left:24},s=a.margin||l,c=a.rowHeight||48,o=t.select(r),u=o.select(".chart-container"),d=u.node().clientWidth,m=d-s.left-s.right,h=i?c:a.elements.length*c+s.bottom,v=h-s.bottom;return{container:o,width:d,height:h,chartWidth:m,chartHeight:v,rowHeight:c,margin:s,dataIsEmpty:i}},r=function(e){if(e.elements){var t=e.elements.slice(),a=t.sort(e.sortFunc);return{elements:a}}return{}},n=function(e){var a=e.domain||[0,0];if(!e.domain&&e.elements){var r=t.merge(e.elements).filter(function(t){return t.key===e.valueKey||t.key===e.referenceKey}).map(function(e){return e.value});a=r.length?t.extent(r):[0,0]}a[0]=Math.min(a[0],0);var n=Math.max(Math.abs(a[0]),Math.abs(a[1]));a=[-n,n];var i=t.scaleLinear().domain(a).range([0,e.chartWidth]);return{scaleX:i}},i=function(e){var a=e.axisXFormat||".2s",r=t.axisBottom().scale(e.scaleX).tickFormat(t.format(a)),n=e.container.select(".axis").attr("transform","translate("+[0,e.chartHeight]+")").attr("display",e.dataIsEmpty?"none":"block").call(r);return{axisX:n}},l=function(e){var t=e.container.select(".header .row").selectAll("div.column").data(e.header||[]);return t.enter().append("div").merge(t).attr("class",function(e){return"column "+e.key}).html(function(e){if(Array.isArray(e.label)){var t=e.label.map(function(e,t){return"<div>"+e+"</div>"}).join("");return'<div class="multiline">'+t+"</div>"}return e.label}),t.exit().remove(),{}},s=function(e){var t=e.container.select(".table-container .content").selectAll("div.row").data(e.elements||[]),a=t.enter().append("div").merge(t).attr("class","row");t.exit().remove();var r=a.selectAll("div.column").data(function(e){return e});r.enter().append("div").merge(r).attr("class","column").html(function(t){if("number"==typeof t.label){var a=function(e){return Math.floor(100*e)/100},r=e.valueFormat||a;return r(t.label)}if(Array.isArray(t.label)){var n=t.label.map(function(e,t){return"<div>"+e+"</div>"}).join("");return'<div class="multiline">'+n+"</div>"}return null===t.label||"undefined"==typeof t.label?e.emptyPlaceholder||"":t.label}),r.exit().remove();var n=e.container.select(".chart-container .rows").selectAll("div.row").data(e.elements||[]);return n.enter().append("div").attr("class","row").append("div").attr("class","column"),n.exit().remove(),{}},c=function(e){var t=e.container.select("svg").attr("width",e.width).attr("height",e.height).select(".panel").attr("transform","translate("+e.margin.left+" 0)").select(".bars").selectAll("g.bar-group").data(e.elements||[]),a=t.enter().append("g").merge(t).attr("class","bar-group").attr("transform",function(t,a){return"translate(0 "+a*e.rowHeight+")"});t.exit().remove();var r=a.selectAll("rect.reference-bar").data(function(t,a){var r=t.filter(function(t){return t.key===e.referenceKey});return[r&&r[0]]});r.enter().append("rect").merge(r).attr("class","reference-bar").attr("width",function(t){return Math.abs(e.scaleX(t.value)-e.scaleX(0))}).attr("height",function(t){return e.rowHeight/2}).attr("x",function(t){return t.value<0?e.scaleX(t.value):e.scaleX(0)}).attr("y",function(t){return e.rowHeight/4}),r.exit().remove();var n=2,i=a.selectAll("rect.reference-line").data(function(t,a){var r=t.filter(function(t){return t.key===e.referenceKey});return[r&&r[0]]});i.enter().append("rect").merge(i).attr("class","reference-line").attr("display",function(e){return e.value||0===e.value?"block":"none"}).attr("width",n).attr("height",function(t){return e.rowHeight/2}).attr("x",function(t){var a=n;return t.value>0&&(a*=-1),e.scaleX(t.value)+a}).attr("y",function(t){return e.rowHeight/4}),i.exit().remove();var l=a.selectAll("rect.value-bar").data(function(t,a){var r=t.filter(function(t){return t.key===e.valueKey});return[r&&r[0]]});return l.enter().append("rect").merge(l).attr("class","value-bar").attr("width",function(t){return Math.abs(e.scaleX(t.value)-e.scaleX(0))}).attr("height",function(t){return e.rowHeight/4}).attr("x",function(t){return t.value<0?e.scaleX(t.value):e.scaleX(0)}).attr("y",function(t){return 3*e.rowHeight/8}),l.exit().remove(),{}},o=function(e){return e.container.on("click",function(){e.events.call("click",null,{event:t.event})}),{}},u=function(e){var t=e.scaleX.ticks(),a=e.container.select(".stripes").selectAll("rect.stripe").data(t);return a.enter().append("rect").attr("class","stripe").merge(a).attr("x",function(a,r){var n=t[Math.max(r-1,0)],i=(e.scaleX(a)-e.scaleX(n))/2;return e.scaleX(a)-i}).attr("y",function(e){return 0}).attr("width",function(a,r){var n=t[Math.max(r-1,0)],i=(e.scaleX(a)-e.scaleX(n))/2;return i=Math.max(i,0)}).attr("height",function(t){return e.chartHeight}),a.exit().remove(),{}},d=function(e){var t=(e.scaleX.ticks(),e.container.select(".stripes").selectAll("line.grid").data([0]));return t.enter().append("line").attr("class","grid").merge(t).attr("display",e.dataIsEmpty?"none":"block").attr("x1",function(t){return e.scaleX(0)+.5}).attr("y1",0).attr("x2",function(t){return e.scaleX(0)+.5}).attr("y2",e.chartHeight),t.exit().remove(),{}},m=function(e){return e.labelsRewriterX?(e.container.selectAll(".axis").selectAll("text").html(function(t,a){return e.labelsRewriterX(t,a,e)}),{}):{}},h=e.utils.pipeline(a,r,l,s,n,o,u,d,i,m,c),v=function(a){var r,n,i=t.dispatch("click"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){r.width=r.parent.clientWidth,c()},200);t.select(window).on("resize."+l,s);var c=function(){n=h(r)},o=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return r=e.utils.mergeAll({},r,{data:a}),c(),this},u=function(t){return r=e.utils.mergeAll(r,t),c(),this},d=function(t,a){u(e.utils.mergeAll(t,{events:a}))},m=function(){t.select(window).on("resize."+l,null),r.parent.innerHTML=null};return d(a,i),{on:e.utils.rebind(i),setConfig:u,setData:o,destroy:m}};e.tableChart=v}(a,r.d3),!function(e,t){var a=function(a){var r=a.parent.querySelector(".datahub-vertical-chart");if(!r){var n='<div class="datahub-vertical-chart"><div class="header"></div><div class="chart-container"><div class="chart-wrapper"><svg><g class="panel"><g class="reference-bars"></g><g class="bars"></g><g class="axis"></g></g></svg></div></div><div class="number-container"></div></div>';r=e.utils.appendHtmlToNode(n,a.parent)}var i=!(a.elements&&a.elements.length),l=t.select(r),s=l.select(".chart-container"),c=s.node().clientWidth,o=26,u=i?0:a.elements.length*o;return{container:l,chartWidth:c,chartHeight:u,rowHeight:o,dataIsEmpty:i,refernceValue:100}},r=function(e){var a=t.scaleLinear().domain([0,100]).range([0,e.referenceBarSize]);return{scaleX:a}},n=function(e){return e.container.select(".header").html(e.title),{}},i=function(e){var t=e.container.select(".number-container").selectAll(".number").data(e.elements||[]),a=t.enter().append("div").merge(t).attr("class",function(e,t){return"number number"+t});t.exit().remove();var r=a.selectAll(".label").data(function(e){return[e]});r.enter().append("div").attr("class","label").merge(r).html(function(e){return e.label}),r.exit().remove();var n=a.selectAll(".value").data(function(e){return[e]});return n.enter().append("div").attr("class","value").merge(n).html(function(t){return Math.round(t.value)+" "+e.unit}),n.exit().remove(),{}},l=function(e){var t=e.container.select("svg").attr("width",e.chartWidth).attr("height",e.chartHeight).select(".panel"),a=e.rowHeight,r=a-2,n=r/2,i=t.select(".bars").selectAll(".bar").data(e.elements||[]);i.enter().append("rect").merge(i).attr("class",function(e,t){return["bar",e.label.toLowerCase(),"bar"+t].join(" ")}).attr("x",function(t){var a=e.scaleX(t.value);return 0>a?e.chartWidth/2-Math.abs(a):e.chartWidth/2}).attr("y",function(e,t){return a*t+(a-n)/2}).attr("width",function(t){return t.value?Math.abs(e.scaleX(t.value)):void 0}).attr("height",n),i.exit().remove();var l=t.select(".reference-bars").selectAll(".bar").data(e.elements||[]);l.enter().append("rect").attr("class","bar").merge(l).attr("x",e.chartWidth/2).attr("y",function(e,t){return a*t+(a-r)/2}).attr("width",function(t,a){return e.referenceBarSize}).attr("height",r),l.exit().remove();var s=t.select(".reference-bars").selectAll(".line").data(e.elements||[]);return s.enter().append("line").attr("class","line").merge(s).attr("x1",e.chartWidth/2+e.referenceBarSize).attr("y1",function(e,t){return a*t+(a-r)/2}).attr("x2",e.chartWidth/2+e.referenceBarSize).attr("y2",function(e,t){return a*t+(a-r)/2+r}),s.exit().remove(),{}},s=function(e){var t=e.container.select(".axis").selectAll(".vertical").data([0]);return t.enter().append("line").attr("class","vertical").merge(t).attr("x1",e.chartWidth/2).attr("y1",0).attr("x2",e.chartWidth/2).attr("y2",e.chartHeight),t.exit().remove(),{}},c=e.utils.pipeline(a,n,i,r,s,l),o=function(a){var r,n,i=t.dispatch("barHover"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){r.width=r.parent.clientWidth,o()},200);t.select(window).on("resize."+l,s);var o=function(){n=c(r)},u=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return r=e.utils.mergeAll({},r,{data:a}),o(),this},d=function(t){return r=e.utils.mergeAll(r,t),o(),this},m=function(t,a){d(e.utils.mergeAll(t,{events:a}))},h=function(){t.select(window).on("resize."+l,null),r.parent.innerHTML=null};return m(a,i),{on:e.utils.rebind(i),setConfig:d,setData:u,destroy:h}};e.verticalChart=o}(a,r.d3),!function(e,t){var a=function(a){var r=a.parent.querySelector(".datahub-waterfall-chart");if(!r){var n='<div class="datahub-waterfall-chart"><div class="chart-container"><svg><g class="panel"><g class="bars"></g><g class="connectors"></g></g></svg></div><div class="number-container"></div></div>';r=e.utils.appendHtmlToNode(n,a.parent)}var i=!(a.elements&&a.elements.length),l=!(!i&&a.elements[0].value),s=t.select(r),c=s.select(".chart-container"),o=a.width||c.node().clientWidth,u=a.height||c.node().clientHeight||300,d=[1,3],m=[1];return{container:s,chartWidth:o,chartHeight:u,dataIsEmpty:l,infoIsEmpty:i,elements:a.elements||[],isConnected:d,isNegative:m}},r=function(e){var a=t.scaleBand().domain(t.range(e.elements.length)).rangeRound([0,e.chartWidth]).paddingInner(.4).paddingOuter(.2);return{scaleX:a}},n=function(e){var a=e.elements.map(function(e){return e.value}),r=t.scaleLinear().domain([0,t.max(a)]).range([0,e.chartHeight]);return{scaleY:r}},i=function(e){var t=e.container.select("svg").attr("width",e.chartWidth).attr("height",e.chartHeight).select(".panel");if(e.dataIsEmpty)return t.select(".bars").selectAll(".bar").remove(),{};var a=t.select(".bars").selectAll(".bar").data(e.elements);return a.enter().append("rect").merge(a).attr("class",function(e,t){return["bar",e.label.toLowerCase(),e.key,"bar"+t].join(" ")}).attr("x",function(t,a){return e.scaleX(a)}).attr("y",function(t,a){var r=e.isConnected.indexOf(a)>-1;if(r){var n=Math.max(0,a-1),i=e.elements[n];return e.isNegative.indexOf(a)>-1?e.chartHeight-e.scaleY(Math.abs(i.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}).attr("width",function(t){return t.value?e.scaleX.bandwidth():void 0}).attr("height",function(t){return e.scaleY(Math.abs(t.value))}),a.exit().remove(),{}},l=function(e){if(e.dataIsEmpty)return e.container.select(".connectors").selectAll(".connector").remove(),{};var t=e.container.select(".connectors").selectAll(".connector").data(e.elements);t.enter().append("line").attr("class","connector").merge(t).attr("x1",function(t,a){return e.scaleX(a)}).attr("y1",function(t,a){var r=e.isConnected.indexOf(a)>-1;if(r){var n=Math.max(0,a-1),i=e.elements[n];return e.isNegative.indexOf(a)>-1?e.scaleY(Math.abs(t.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}).attr("x2",function(t,a){return e.scaleX(Math.min(a+1,e.elements.length-1))}).attr("y2",function(t,a){var r=e.isConnected.indexOf(a)>-1;if(r){var n=Math.max(0,a-1),i=e.elements[n];return e.isNegative.indexOf(a)>-1?e.chartHeight-e.scaleY(Math.abs(i.value))+e.scaleY(Math.abs(t.value)):e.chartHeight-e.scaleY(Math.abs(i.value))-e.scaleY(Math.abs(t.value))}return e.chartHeight-e.scaleY(Math.abs(t.value))}),t.exit().remove();var t=e.container.select(".connectors").selectAll(".base").data([0]);return t.enter().append("line").attr("class","base").merge(t).attr("x1",e.scaleX(0)).attr("y1",e.chartHeight).attr("x2",e.scaleX(Math.max(e.elements.length-1,0))+e.scaleX.bandwidth()||0).attr("y2",e.chartHeight),t.exit().remove(),{}},s=function(e){var t=e.container.select(".number-container").selectAll(".number").data(e.elements),a=t.enter().append("div").merge(t).attr("class",function(e,t){return"number number"+t});t.exit().remove();var r=a.selectAll(".label").data(function(e){return[e]});r.enter().append("div").attr("class","label").merge(r).html(function(e){return e.label}),r.exit().remove();var n=a.selectAll(".value").data(function(e){return[e]});return n.enter().append("div").attr("class","value").merge(n).html(function(e){return"undefined"==typeof e.value?'<div class="error">(Data Unavailable)</div>':Math.round(e.value)}),n.exit().remove(),{}},c=e.utils.pipeline(a,r,n,i,l,s),o=function(a){var r,n,i=t.dispatch("barHover"),l=~~(1e4*Math.random()),s=e.utils.throttle(function(){r.width=r.parent.clientWidth,o()},200);t.select(window).on("resize."+l,s);var o=function(){n=c(r)},u=function(t){var a=t?JSON.parse(JSON.stringify(t)):{};return r=e.utils.mergeAll({},r,{data:a}),o(),this},d=function(t){return r=e.utils.mergeAll(r,t),o(),this},m=function(t,a){d(e.utils.mergeAll(t,{events:a}))},h=function(){t.select(window).on("resize."+l,null),r.parent.innerHTML=null};return m(a,i),{on:e.utils.rebind(i),setConfig:d,setData:u,destroy:h}};e.waterfallChart=o}(a,r.d3);var a=e="object"==typeof e?e:{},r="object"==typeof t?t:window;"object"==typeof module&&module.exports?r.d3=require("d3"):r.d3=r.d3,"object"==typeof module&&module.exports&&(module.exports=e),t.datahub=e}({},function(){return this}());