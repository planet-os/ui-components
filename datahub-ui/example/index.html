<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.2/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.0/d3.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="../src/datahub-utils.js"></script>
    <script src="../src/datahub-palette.js"></script>
    <script src="../src/datahub-data.js"></script>
    <script src="../src/datahub-map.js"></script>
    <script src="../src/datahub-chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.2/leaflet.css" />
    <style>
    .map, .chart {
        width: 512px;
        height: 512px
    }

    .chart .shape {
        stroke: red;
    }
    </style>
</head>

<body>
    <div class="map"></div>
    <div class="chart"></div>
    <script>
    /*
        TODO:
        - generators: random walk, perlin noise
    */

    /*
        upgrades:
        - d3v4 scales
        - which scale as rgb, uses custom parser
        - default imagePath
        - removed datahubmap util for datahub.utils
        - datahub.map.rasterMap
    */

    console.log(datahub)

    var dateNow = new Date().getTime()

    datahub.chart.timeseriesLineChart({
            container: document.querySelector('.chart'),
            width: 500,
            height: 300,
            margin: { top: 50, right: 70, bottom: 90, left: 60 },
            data: {
                values: [1, 2, 3],
                timestamps: [new Date(dateNow), new Date(dateNow + 86400), new Date(dateNow + 86400*2)]
            },
            axisTitleY: 'Unit'
        });

    var datasetName = 'noaa_gfs_global_sflux_0.12d'
    var variableName = 'Temperature_hybrid'

    datahub.data.getPreview(datasetName, variableName, null, function(response){
        console.log(111, response);
        mainMap.renderRaster(response.json)
    });

    var rasterData = datahub.data.generateRaster()
    var polygon = datahub.data.generateGeojson()

    var mainMap = datahub.map.rasterMap({
            el: document.querySelector('.map'),
            colorScale: datahub.palette.equalizedSpectral,
            // colorScale: colorScales.grayscale,
            zoom: 1
        })
        .init()
        // .renderRaster(rasterData)
        // .addMarker([0, 0])
        // .renderPolygon(polygon)
        // .zoomToPolygonBoundingBox(polygon)

    // mainMap.events.click.on(function(e) {
    //     console.log(e);
    // });

    </script>
</body>

</html>
