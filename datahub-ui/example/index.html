<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.7/leaflet.draw.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.0/d3.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="../src/datahub-utils.js"></script>
    <script src="../src/datahub-palette.js"></script>
    <script src="../src/datahub-data.js"></script>
    <script src="../src/datahub-map.js"></script>
    <script src="../src/datahub-common.js"></script>
    <script src="../src/datahub-widget.js"></script>
    <script src="../src/datahub-group.js"></script>
    <script src="../src/datahub-chart.js"></script>
    <script src="../src/datahub-table-chart.js"></script>
    <script src="../src/datahub-vertical-chart.js"></script>
    <script src="../src/datahub-waterfall-chart.js"></script>
    <script src="../src/datahub-legend.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.2/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.7/leaflet.draw.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" href="../style/components.css" />
    <link rel="stylesheet" href="../style/dark-theme.css" />
    <style>
    div {
        /*border: 1px solid silver;*/
    }
    
    .map {
        width: 512px;
        height: 512px;
        margin: 0 auto;
    }
    
    .map-group {
        width: 550px;
        margin: 0 auto;
    }
    
    .map-group .map {
        width: 256px;
        height: 256px;
    }
    
    .map-group .map:not(:last-child) {
        margin-right: 10px;
    }
    
    .chart {
        width: 512px;
        height: 300px;
        margin: 0 auto;
    }
    
    .vertical-buttons {
        height: 200px;
        width: 60px;
        margin: 0 auto;
    }
    
    .section {
        max-width: 64em;
        margin: 0 auto 20px auto;
        padding: 20px;
    }
    
    .button-group.vertical {
        max-width: 64px;
    }
    
    .month-calendar, .dropdown-calendar, .dropdown1 {
        width: 200px;
    }
    
    .selected-date {
        padding-bottom: 20px;
        width: 200px;
        text-align: center;
    }
    </style>
</head>

<body>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A bar chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="negative-bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A bar chart can handle negative values.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="reverse-bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A bar chart can reverse its Y axis.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="autoscale-bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A bar chart can autoscale it's Y axis.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="domain-bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A bar chart can force a Y domain.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="stacked-bar-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A stacked bar chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="multi-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">All chart features superimposed.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="multiline-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A timeseries chart can have multiple lines.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="area-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">An area chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="stacked-area-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A stacked area chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="chart-types"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart can mix multiple types.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="chart-features"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart can have background reference bar and a threshold line.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="data-change"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart can update data.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="data-empty"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart can clear data.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="time-slider"></div>
            <div class="slider-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A time slider is used to zoom in a timeseries.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="gaps"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">Stacked area chart handle data with gaps.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="gaps2"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">Line and area charts handle data with gaps.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="isolated"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">Line and area charts handle isolated data points.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="multiline-chart-empty"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart has an empty state.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="chart-dummy dummy"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A chart can have a "dummy" state to act like a placeholder.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="table-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A table chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="vertical-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A vertical bar chart with reference bar and summary numbers.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="waterfall-chart"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A waterfall chart.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="number-widget big col-xs"></div>
                <div class="number-widget medium col-xs"></div>
                <div class="number-widget small col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A number widget comes in 3 sizes. It can have a title, a value and some info.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="number-group small col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">Number widgets can be grouped.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="table-widget col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A table can be sorted. It can handle html styles.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="button-group vertical col-xs"></div>
                <div class="button-group horizontal col-xs"></div>
                <div class="button-group exclusive col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A group of buttons can be stacked vertically or horizontally. It can also be exclusive, forcing only one button to be selected.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="legend col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A group of buttons accepts html labels and can be styled as a legend. Legend element can be toggled on or off.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="alert-message1 col-xs"></div>
                <div class="alert-message2 col-xs"></div>
                <div class="alert-message3 col-xs"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">An alert message has a colored band with icon and a message.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="tags col-xs">
                    <div class="dh-tag">3,10%</div>
                    <div class="dh-tag negative">-3,10%</div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A simple tag style.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="tags col-xs">
                    <div class="selected-date"></div>
                    <div class="month-calendar"></div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A month calendar.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="tags col-xs">
                    <div class="dropdown1"></div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A dropdown.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row">
                <div class="tags col-xs">
                    <div class="dropdown-calendar"></div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A dropdown calendar.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row map-group">
                <div class="map map-light"></div>
                <div class="map map-dark"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A map can have a light or dark basemap.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="row map-group">
                <div class="map map-grayscale"></div>
                <div class="map map-rainbow"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A map can load raster data. Multiple palettes are available, like a simple linear grayscale and a rainbow palette using histogram equalization.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="map map-raster"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A map can zoom and pan raster efficiently. A tooltip shows value under the cursor.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="map map-vector"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A map can load vector data, points and polygons.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="map map-selector"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A vector map supports markers and rectangle selection. Clicking on the selection deletes it.</div>
        </div>
    </div>
    <div class="row section">
        <div class="col-xs-12 col-md-7">
            <div class="map-legend"></div>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="description">A color palette legend to go with the map.</div>
        </div>
    </div>
    <script>

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries({min: 100, max: 10000})
    }

    var container = document.querySelector('.bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries(),
        referenceData: datahub.data.generateTimeSeries()
    }

    dataMulti.barData.forEach(function(d) {
        if(Math.random()>0.5){
            d.value = d.value * -1
        }
    })

    dataMulti.referenceData.forEach(function(d) {
        if(Math.random()>0.5){
            d.value = d.value * -1
        }
    })

    var container = document.querySelector('.negative-bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries(),
        referenceData: datahub.data.generateTimeSeries()
    }

    dataMulti.barData.forEach(function(d) {
        d.value = d.value * -1
    })

    dataMulti.referenceData.forEach(function(d) {
        d.value = d.value * -1
    })

    var container = document.querySelector('.reverse-bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti,
        reverseY: true
    })
    .on('hover', function(d) { console.log(d) })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries()
    }

    dataMulti.barData.map(function(d) {
        return d.value.map(function(dB) {
            return Math.random()*50+50
        })
    })

    var container = document.querySelector('.autoscale-bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti,
        autoScaleY: true
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries()
    }

    var container = document.querySelector('.domain-bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti,
        domain: [0, 1000]
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        stackedBarData: datahub.data.generateTimeSeries({layerCount: 3})
    }

    var container = document.querySelector('.stacked-bar-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        lineData: datahub.data.generateTimeSeries({layerCount: 2})
    }

    var container = document.querySelector('.multiline-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        areaData: datahub.data.generateTimeSeries()
    }

    var container = document.querySelector('.area-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        stackedAreaData: datahub.data.generateTimeSeries({layerCount: 3})
    }

    var container = document.querySelector('.stacked-area-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries(),
        stackedBarData: datahub.data.generateTimeSeries({count: 8, layerCount: 3}),
        estimateData: datahub.data.generateTimeSeries({count: 4, timeStart: '2016-09-01'}),
        lineData: datahub.data.generateTimeSeries({layerCount: 2}),
        areaData: datahub.data.generateTimeSeries(),
        stackedAreaData: datahub.data.generateTimeSeries({layerCount: 3}),
        referenceData: datahub.data.generateTimeSeries({count: 8}),
        thresholdData: datahub.data.generateTimeSeries({count: 1, step: 12})
    }

    console.log(dataMulti)

    var container = document.querySelector('.multi-chart')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        height: 300,
        margin: {
            top: 50,
            right: 40,
            bottom: 90,
            left: 60
        },
        axisXFormat: '%b',
        axisTitleX: 'Unit',
        axisTitleY: 'Unit',
        chartTitle: 'Title'
    })
    .on('hover', function(d) { console.log(d) })
    .setData(dataMulti)
    .setConfig({chartTitle: 'Title2'})

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries()
    }

    var container = document.querySelector('.data-change')
    var chart = datahub.chart.multi({
        parent: container,
        width: container.clientWidth
    })

    function setData() {
        var dataMulti = {
            timestamp: datahub.data.generateTimestamps(),
            barData: datahub.data.generateTimeSeries()
        }
        chart.setData(dataMulti)
    }

    setInterval(setData, 1000)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries()
    }

    var container = document.querySelector('.data-empty')
    var chart2 = datahub.chart.multi({
        parent: container,
        width: container.clientWidth
    })
    .setData(dataMulti)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: null
    }
    chart2.setData(dataMulti)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        stackedBarData: datahub.data.generateTimeSeries({count: 8, layerCount: 3}),
        estimateData: datahub.data.generateTimeSeries({timeStart: '2016-09-01', count: 4, layerCount: 1})
    }

    var container = document.querySelector('.chart-types')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries(),
        referenceData: datahub.data.generateTimeSeries(),
        thresholdData: datahub.data.generateTimeSeries({count: 1, step: 12})
    }

    var container = document.querySelector('.chart-features')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var container = document.querySelector('.multiline-chart-empty')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        barData: datahub.data.generateTimeSeries(),
    }

    var container = document.querySelector('.chart-dummy')
    datahub.chart.multi({
        parent: container,
        width: container.clientWidth,
        data: dataMulti
    })

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        stackedAreaData: datahub.data.generateTimeSeries({count: 12, layerCount: 3})
    }

    dataMulti.stackedAreaData[10].value = dataMulti.stackedAreaData[10].value.slice(0, 2)
    dataMulti.stackedAreaData[6].value = dataMulti.stackedAreaData[6].value.slice(1, 2)

    datahub.chart.multi({
        parent: document.querySelector('.gaps')
    })
    .setData(dataMulti)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        lineData: datahub.data.generateTimeSeries({count: 12, layerCount: 3}),
        areaData: datahub.data.generateTimeSeries({count: 12, layerCount: 3})
    }

    dataMulti.lineData.forEach(function(d) {
        d.value =  d.value.map(function(dB, iB) {
            return !!Math.round(Math.random()*3) ? dB : null
        })
    })

    dataMulti.areaData.forEach(function(d) {
        d.value =  d.value.map(function(dB, iB) {
            return !!Math.round(Math.random()*3) ? dB : null
        })
    })

    datahub.chart.multi({
        parent: document.querySelector('.gaps2')
    })
    .setData(dataMulti)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        lineData: datahub.data.generateTimeSeries({count: 1, layerCount: 3}),
        areaData: datahub.data.generateTimeSeries({count: 1, layerCount: 1})
    }

    datahub.chart.multi({
        parent: document.querySelector('.isolated')
    })
    .setData(dataMulti)

    var dataMulti = {
        timestamp: datahub.data.generateTimestamps(),
        lineData: datahub.data.generateTimeSeries({count: 12, layerCount: 2})
    }

    var sliderChartContainer = document.querySelector('.slider-chart')

    function renderMainChart(dataMulti) {
        datahub.chart.multi({
            parent: sliderChartContainer,
            width: sliderChartContainer.clientWidth,
            data: dataMulti
        })
    }

    var timeSliderContainer = document.querySelector('.time-slider')
    var timeSlider = datahub.widget.timeSlider({
        parent: timeSliderContainer,
        timeRange: ['2016-01-01', '2017-01-01'],
        initialTimeRange: ['2016-01-01', '2017-01-01'],
        width: timeSliderContainer.clientWidth,
        height: 40,
        margin: {
            top: 4,
            right: 60,
            bottom: 4,
            left: 60
        }
    })

    timeSlider.events.on('brush', function(d) {
        // var timestamps = timeseries.map(function(d, i){ return d.timestamp })
        // var startIndex = datahub.utils.bisection(timestamps, d.brushExtent.start)
        // var endIndex = datahub.utils.bisection(timestamps, d.brushExtent.end)
        // var timeseriesSlice = {
        //     values: dataMulti.values.map(function(d, i) {
        //         return d.slice(startIndex, endIndex)
        //     }),
        //     timestamps: dataMulti.timestamps.slice(startIndex, endIndex)
        // }

        // renderMainChart(timeseriesSlice)
    })

    renderMainChart(dataMulti)

    var table = datahub.tableChart({
        parent: document.querySelector('.table-chart')
    })

    table.setConfig({
            header: [
                {key: 'name', label: 'Name'},
                {key: 'actual', label: ['Actual', '2nd']},
                {key: 'plan', label: 'Plan'}
            ],
            elements: [
                [
                    {key: 'name', value: 'Spain', label: 'Spain' },
                    {key: 'actual', value: -20, label: -20 },
                    {key: 'plan', value: -30, label: -30 }
                ],
                [
                    {key: 'name', value: 'germany', label: 'Germany' },
                    {key: 'actual', value: 10, label: 10 },
                    {key: 'plan', value: 40, label: 40 }
                ],
                [
                    {key: 'name', value: 'zzz', label: 'UK' },
                    {key: 'actual', value: 30, label: [30, 'Wh'] },
                    {key: 'plan', value: 40, label: 40 }
                ],
                [
                    {key: 'name', value: 'mmm', label: 'Italy' },
                    {key: 'actual', value: 10, label: 10 },
                    {key: 'plan', value: 40, label: 40 }
                ]
            ],
            valueKey: 'actual',
            referenceKey: 'plan',
            domain: [-40, 160],
            sortFunc: function(a, b) {
                var forceTop = 'zzz'
                var matchA = a.filter(function(d) {
                    return d.key === 'name'
                })
                var nameA = matchA[0].label.toLowerCase()

                var matchB = b.filter(function(d) {
                    return d.key === 'name'
                })
                var nameB = matchB[0].label.toLowerCase()

                if(nameB === forceTop) {
                    return 1
                }
                if(nameA === forceTop) {
                    return -1
                }
                if(nameA < nameB) {
                    return -1
                }
                if(nameA > nameB) {
                    return 1
                }
                return 0
            }
        })

    var vertical = datahub.verticalChart({
        parent: document.querySelector('.vertical-chart')
    })

    vertical.setConfig({
        title: 'Title',
        elements:[
            {key: 'approved', label: 'Approved', value: 125},
            {key: 'written', label: 'Written', value: 16},
            {key: 'remains', label: 'Remains', value: -79}
        ],
        referenceBarSize: 100,
        unit: '%'
    })

    var waterfall = datahub.waterfallChart({
        parent: document.querySelector('.waterfall-chart')
    })

    waterfall.setConfig({
        elements:[
            {key: 'initial', label: 'Initial', value: 53},
            {key: 'closed', label: 'Closed', value: -30},
            {key: 'open', label: 'Open', value: 23},
            {key: 'new', label: 'New', value: 15},
            {key: 'total', label: 'Total', value: 38}
        ]
    })

    var number = datahub.widget.number({
            parent: document.querySelector('.number-widget.big'),
            title: 'title',
            value: 'value',
            info: 'info'
        })
        .on('click', function(d){ console.log(d) })

    number.setTitle('NET PRODUCTION')
        .setValue('236,43GWh<div class="dh-tag">3,10%</div>')
        .setInfo('Plan: 231,64GWh')

    datahub.widget.number({
        parent: document.querySelector('.number-widget.medium'),
        value: '236,43GWh',
        info: 'Net Production'
    })

    datahub.widget.number({
        parent: document.querySelector('.number-widget.small'),
        value: '16,00%',
        info: 'MTD Actual'
    })

    var numberGroup = datahub.group.number({
        parent: document.querySelector('.number-group'),
        values: ['235,43GWh', '235,43GWh', '15,00%'],
        infos: ['Net Production', 'Plan: 231,64GWh', 'MTD Actual'],
        titles: ['Title 1', 'Title 2', 'Title 3']
    })

    numberGroup.setValues(['236,43GWh', '236,43GWh', '16,00%'])

    var table = datahub.widget.table({
        parent: document.querySelector('.table-widget'),
        header: [{
            key: 'header1',
            label: 'Header 1',
            sortable: true
        }],
        elements: [['Element 1']]
    })

    table.setHeader([{
        key: 'country',
        label: 'Country',
        sortable: true
    }, {
        key: 'production',
        label: 'Production',
        sortable: true
    }, {
        key: 'revenues',
        label: 'Revenues',
    }])

    table.setElements([
        ['Spain', '1<span class="dh-tag">3,10%</span>', '<span class="dh-negative">(2)</span>'],
        ['Germany', '7 <span class="dh-negative-arrow"></span>', '8 <span class="dh-positive-arrow"></span>'],
        ['United Kingdom', '<span class="dh-positive-cell">1<span>', 2],
        ['Poland', '95% <span class="dh-dim">/ 80%</span>', 8],
        ['Netherlands', 1, 2],
        ['Italy', 7, 8],
    ])

    var heightSelector = datahub.widget.buttonGroup({
        parent: document.querySelector('.button-group.vertical'),
        elements: [{
            label: 'All',
            key: 'all'
        }, {
            label: '200',
            key: '200'
        }, {
            label: '180',
            key: '180'
        }, {
            label: '160',
            key: '160'
        }],
        defaultElementKey: 'all',
        isExclusive: true
    })

    heightSelector.events.on('click', function(d) {
        console.log(d)
    })

    datahub.widget.buttonGroup({
        parent: document.querySelector('.button-group.horizontal'),
        elements: [{
            label: 'All',
            key: 'all'
        }, {
            label: '200',
            key: '200'
        }, {
            label: '180',
            key: '180'
        }, {
            label: '160',
            key: '160'
        }],
        defaultElementKey: 'all'
    })

    datahub.widget.buttonGroup({
        parent: document.querySelector('.button-group.exclusive'),
        elements: [{
            label: 'All',
            key: 'all'
        }, {
            label: '200',
            key: '200'
        }, {
            label: '180',
            key: '180'
        }, {
            label: '160',
            key: '160'
        }],
        defaultElementKey: 'all',
        isExclusive: true
    })

    datahub.widget.buttonGroup({
        parent: document.querySelector('.legend'),
        elements: [{
            label: 'Legend element 1 <span class="units">(MWh)</span>',
            key: 'element1',
            className: 'color-1'
        }, {
            label: 'Legend element 2 <span class="units">(MWh)</span>',
            key: 'element2',
            className: 'color-2'
        }],
        defaultElementKey: 'element1'
    })

    var alert = datahub.widget.alertMessage({
        parent: document.querySelector('.alert-message1'),
        level: 'low',
        message: 'Alert message'
    })

    alert.setLevel('low')
    alert.setMessage('Alert message, low')

    datahub.widget.alertMessage({
        parent: document.querySelector('.alert-message2'),
        level: 'medium',
        message: 'Alert message, medium'
    })

    datahub.widget.alertMessage({
        parent: document.querySelector('.alert-message3'),
        level: 'high',
        message: 'Alert message, high'
    })

    var monthCalendar = datahub.widget.monthCalendar({
            parent: document.querySelector('.month-calendar'),
            defaultDate: (new Date()).toString(),
        })
        .on('change', setDate)

    monthCalendar.setDate('2015-10-01T04:00:00.000Z')

    function setDate(d) {
        console.log(monthCalendar.getFormattedDate('%Y/%m/%d %H:%M'));
        document.querySelector('.selected-date').innerText = d.iso
    }

    var dropdown = datahub.widget.dropdown({
        parent: document.querySelector('.dropdown1'),
        elements: [{
            label: 'Element 1',
            key: 'element1'
        }],
        selected: 'Element 1',
        title: 'title1'
    })
    .on('change', function(d){ console.log(d) })

    dropdown.setElements([
        {
            label: 'Element 1',
            key: 'element1'
        }, {
            label: 'Element 2',
            key: 'element2'
        }
    ])
    dropdown.setSelected('Element 2')

    datahub.widget.dropdownCalendar({
        parent: document.querySelector('.dropdown-calendar'),
        defaultDate: (new Date()).toString()
    })
    .on('change', function(d){ console.log(d) })

    datahub.data.setApiKey('0f58fe2540fa4cf19a4aa68f290fd148')

    datahub.map.rasterMap({
            parent: document.querySelector('.map-light'),
            showLabels: false,
            mapConfig: {
                zoomControl: false
            },
            showTooltip: false
        })
        .init()

    datahub.map.rasterMap({
            parent: document.querySelector('.map-dark'),
            basemapName: 'basemapLight',
            showLabels: false,
            mapConfig: {
                zoomControl: false
            },
            showTooltip: false
        })
        .init()

    var datasetName = 'noaa_gfs_global_sflux_0.12d'
    var variableName = 'Temperature_hybrid'
    datahub.data.getPreview(datasetName, variableName, null, function(response) {
        rasterMap.renderRaster(response.json)
        rasterMapGrayscale.renderRaster(response.json)
    })

    var rasterMap = datahub.map.rasterMap({
            parent: document.querySelector('.map-grayscale'),
            colorScale: datahub.palette.grayscale,
            showLabels: false,
            mapConfig: {
                zoomControl: false
            },
            showTooltip: false
        })
        .init()

    var rasterMapGrayscale = datahub.map.rasterMap({
            parent: document.querySelector('.map-rainbow'),
            colorScale: datahub.palette.equalizedSpectral,
            showLabels: false,
            mapConfig: {
                zoomControl: false
            },
            showTooltip: false
        })
        .init()

    datahub.data.getJSON('../asset/gfs_data.json', function(error, json) {
        rasterMapBig.renderRaster(json)
        colorLegend.setData(json.uniqueValues)
    })

    var rasterMapBig = datahub.map.rasterMap({
            parent: document.querySelector('.map-raster'),
            colorScale: datahub.palette.equalizedSpectral
        })
        .init()
        .renderVectorMap()

    var pointsGeojson = datahub.data.generateGeojsonPoints()

    var vectorMap = datahub.map.rasterMap({
            parent: document.querySelector('.map-vector')
        })
        .init()
        .renderPolygon(pointsGeojson)

    datahub.data.getWorldVector(function(geojson) {
        vectorMap.renderPolygon(geojson)
    })

    datahub.map.selectorMap({
        parent: document.querySelector('.map-selector')
    })

    var colorLegend = datahub.colorLegend({
        parent: document.querySelector('.map-legend'),
        height: 50,
        colorScale: datahub.palette.equalizedSpectral
    })

    </script>
</body>

</html>
